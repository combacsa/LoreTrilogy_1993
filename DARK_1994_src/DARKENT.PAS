Unit DarkEnt;

INTERFACE

Uses
   Crt, Graph, UHanX, DarkSub, DarkBatt, DarkEnd;

 Procedure EnterMode;
 Procedure Sign;


IMPLEMENTATION

Procedure EnterMode;
begin
   case party.map of
      1 : begin
             if at(20,11) then
             if wantenter('로어 성') then begin
                with party do begin
                   map := 6; xaxis := 51; yaxis := 94;
                end;
                Load;
                for i := 49 to 53 do Putmap(i,88,44);
                if party.etc[50] and bit1 > 0 then Putmap(89,23,44);
                if party.etc[50] and bit2 > 0 then Putmap(9,64,44);
                if party.etc[50] and bit3 > 0 then Putmap(21,33,44);
                if party.etc[50] and bit4 > 0 then Putmap(88,38,44);
                if party.etc[10] = 4 then begin
                   Pause(TRUE);
                   Clear;
                   Print(7,' 당신이 로어 성에 들어오자  주민들의 열렬한');
                   Print(7,'환영을 받았다.  하지만 주민들은 당신이 메너');
                   Print(7,'스에서 레드 안타레스가 악마 사냥꾼에게 거의');
                   Print(7,'패배했던 당신을 도와준 사실을  알 턱이 없었');
                   Print(7,'다. 메너스의 살인 원인을 제거 하는데 당신이');
                   Print(7,'한 일은 사실 아무것도 없다는 점에 당신은 씁');
                   Print(7,'쓸한 웃음을 지을 수 밖에 없었다.');
                end;
                if party.etc[10] = 16 then begin
                   Clear;
                   Print(7,' 당신이 서둘러 로어 성에 다다랐지만 이미 로');
                   Print(7,'어 성은 폐허가 되어 버렸다.');
                   Print(7,' 당신은 아찔한 감을 느끼며  알비레오의 예언');
                   Print(7,'에 굴복함을 느꼈다. 이제는 다시 돌이킬 수가');
                   cPrint(7,11,'없는 일이 일어나 버렸다. ','우리는 다크 메이지','');
                   Print(11,'실리안 카미너스에게 완패한 것이었다.');
                   with party do begin
                      map := 1; xaxis := 20; yaxis := 11;
                   end;
                   Load;
                   PressAnyKey;
                   Scroll(FALSE);
                   Print(7,' 다크 메이지는 가공할 힘으로 전 대륙에 결계');
                   Print(7,'를 형성하기 시작했고 결계속의 물체들은 서서');
                   Print(7,'히 형체를 잃어가기 시작했다.  이제는 실리안');
                   Print(7,'카미너스를 제어할 수있는 메피스토펠레스마저');
                   Print(7,'사라져 버려서  그녀는 의지의 중심을 잃고 한');
                   Print(7,'없이 그녀의 힘을 방출하기 시작했다.');
                   Print(7,' 이제는 누구도 그녀의 기하 급수적인 힘의 폭');
                   Print(7,'주를 막을 수가 없었고 이미 당신의 의식도 흐');
                   Print(7,'려져 갔다.');
                   PressAnyKey;
                   Print(7,' 하지만 이때, 실리안 카미너스의 마법 결계를');
                   Print(7,'깨트리며 희미한 의지가 스며들어왔다. 그것은');
                   Print(7,'레드 안타레스의 마지막 의지였고 그는 그녀의');
                   Print(7,'결계를 버티며 마지막 말을 한다.');
                   Print(7,'');
                   Print(13,' 다크 메이지의 힘은 영혼인 나조차도 소멸 시');
                   Print(13,'킬 힘이 있다는 걸 알았네.  지금은 나의 마법');
                   Print(13,'력으로 나 혼자 정도를 보호할 수 있는 결계를');
                   Print(13,'구성했지만 곧 나의 힘도 다하게 될 걸세.  나');
                   Print(13,'는 마지막으로 한가지의 묘안을 생각해 내었네');
                   Print(13,'. 자네는 알비레오의 예언을 기억 하겠지.  그');
                   Print(13,'중 마지막 예언을 외워보게.  거기에는 대단한');
                   Print(13,'모순이 있네. 지금은 그의 세번째 예언인 " 네');
                   Print(13,'크로만서에게 이긴자는 아무도 없었다. " 라는');
                   Print(13,'구절이 실행되지 않은 예언이라고 생각되고 있');
                   Print(13,'지.  하지만 반대로 생각해보게.  자네가 만약');
                   Print(13,'지금이라도 네크로만서에게 패한다면 네번째의');
                   Print(13,'예언이 실현 되지 않는 예언이 된다네. 그렇게');
                   Print(13,'만 된다면  다크 메이지는 처음부터 없었던 존');
                   Print(13,'재가 되어 버리고  로어 대륙은 원래의 모습대');
                   Print(13,'로 시간을 진행해 나가게 된다네. 나의 결계가');
                   Print(13,'점점 약해져 가는군. 나의 소멸을 헛되게 하지');
                   Print(13,'는말게.  그리고 자신보다 로어의 운명을 먼저');
                   Print(13,'생각하도록 하게.... 그..그럼... 다..다음 세');
                   Print(13,'상에서......');
                   Print(7,'');
                   PressAnyKey;
                   Print(7,' 그의 의지는 점점 희미해 지더니 결국 암흑으');
                   Print(7,'로 사라지고 말았다.');
                   Print(7,' 당신은 어떻게 하겠는가 ?');
                   m[0] := '';
                   m[1] := '레드 안타레스의 말대로 한다';
                   m[2] := '다크 메이지와 싸우고 싶다';
                   k := Select(140,2,2,FALSE,TRUE);
                   if k < 2 then End_Demo;
                   Print(7,' 일행은 스스로의 능력을 믿기로 하고  실리안');
                   Print(7,'카미너스를 공격하려했다.');
                   PressAnyKey;
                   enemynumber := 1;
                   joinenemy(enemynumber,75);
                   enemy[enemynumber].name := '실리안 카미너스';
                   DisplayEnemies(TRUE);
                   Print(13,' 크악~~ 네가 이 곳의 마지막 생존자냐 ? 그렇');
                   Print(13,'다면 너도 죽여주지.');
                   PressAnyKey;
                   Print(7,' 실리안 카미너스는 다시 8 조각으로 자신을 분');
                   Print(7,'해해서 자신을 8 명으로 만들었다.');
                   PressAnyKey;
                   repeat
                      enemynumber := 8;
                      for i := 1 to enemynumber do begin
                         joinenemy(i,75);
                         with enemy[i] do begin
                            name := '실리안 카미너스';
                            resistance := 255;
                         end;
                      end;
                      DisplayEnemies(TRUE);
                      BattleMode(FALSE,TRUE);
                      if party.etc[6] = 254 then exit;
                      if party.etc[6] = 2 then begin
                         Clear;
                         Print(13,' 크크크.. 너희들은 반드시 나의 손에 죽어 줘');
                         Print(13,'야 겠다. 크크크..');
                         PressAnyKey;
                      end;
                   until FALSE;
                end;
             end;
             if at(76,57) then
             if wantenter('라스트디치 성') then begin
                if party.etc[10] >= 16 then begin
                   Print(7,' 라스트 디치성은 용암의 대지로 변했다.');
                   exit;
                end;
                with party do begin
                   map := 7; xaxis := 38; yaxis := 69;
                end;
                Load;
                if party.etc[50] and bit8 > 0 then PutMap(41,18,44);
                if (party.etc[51] and bit1 = 0) and (party.etc[32] and bit6 > 0)
                   and (party.etc[35] and bit5 = 0)  then PutMap(54,56,53);
             end;
             if at(17,89) then
             if wantenter('메너스') then begin
                if party.etc[10] >= 16 then begin
                   Print(7,' 메너스는  형체도 알아 볼 수 없을 정도로 무');
                   Print(7,'너져 버렸다.');
                   exit;
                end;
                with party do begin
                   map := 10; xaxis := 26; yaxis := 44;
                end;
                Load;
                case party.etc[10] of
                   1 : for i := 25 to 26 do putmap(i,43,52);
                   3 : for i := 25 to 26 do putmap(i,43,52);
                   9 : begin
                          for i := 24 to 27 do PutMap(i,9,0);
                          for i := 23 to 28 do PutMap(i,10,0);
                          for i := 23 to 28 do PutMap(i,11,0);
                          for i := 24 to 27 do PutMap(i,12,0);
                       end;
                   12: begin
                          for i := 12 to 14 do PutMap(i,10,0);
                          for i := 11 to 15 do putMap(i,11,0);
                          for i := 12 to 14 do PutMap(i,12,0);
                       end;
                   15: begin
                          with party do begin
                             map := 4; xaxis := 10; yaxis := 92;
                          end;
                          Load;
                          Clear;
                          Print(7,'당신이 메너스에 입구에 들어서자 마자 저항할');
                          Print(7,'수 없는 강한 힘이 일행을 빨아들이기 시작 했');
                          Print(7,'다. 순간 당신은 메너스의 입구 자체가 커다란');
                          Print(7,'통로로 변해 있음을 알아 챘다.');
                          party.etc[9] := party.etc[9] or bit1;
                          Scroll(FALSE);
                          PressAnyKey;
                          Delete_Scroll_Screen;
                          face := 4;
                          Print(7,' 한참 후에 당신은 정신이 들었고 여기가 지하');
                          Print(7,'세계임을 알아 차렸다.');
                       end;
                end;
             end;
             if at(84,86) then
             if wantenter('알수없는 피라미드') then begin
                if party.etc[10] >= 16 then begin
                   Print(7,' 그러나, 피라미드는 파괴 되었다.');
                   exit;
                end;
                with party do begin
                   map := 2; xaxis := 99; yaxis := 100;
                end;
                Load;
                move(Font^[48],Font^[52],294);
             end;
          end;
      2 : begin
             if at(100,100) then
             if wantexit then begin
                with party do begin
                   map := 1; xaxis := 83; yaxis := 86;
                end;
                Load;
             end;
             if at(16,16) then
             if wantenter('흉성의 증거') then begin
                with party do begin
                   map := 11; xaxis := 25; yaxis := 44;
                end;
                Load;
             end;
             if at(149,65) then
             if wantenter('흉성의 단서') then begin
                with party do begin
                   map := 12; xaxis := 25; yaxis := 44;
                end;
                Load;
             end;
          end;
      3 : begin
             if at(66,78) then
             if wantenter('빛의 지붕') then begin
                with party do begin
                   map := 8; xaxis := 25; yaxis := 93;
                end;
                Load;
                if party.etc[40] and bit1 > 0 then PutMap(25,61,48);
             end;
             if at(89,94) then
             if wantenter('빛의 사원') then begin
                with party do begin
                   map := 13; xaxis := 25; yaxis := 7;
                end;
                Load;
             end;
             if at(33,49) then
             if wantenter('필멸의 생존') then begin
                with party do begin
                   map := 14; xaxis := 25; yaxis := 44;
                end;
                Load;
                if party.etc[40] and bit8 = 0 then begin
                   for j := 6 to 17 do
                   for i := 17 to 36 do PutMap(i,j,31);
                end
                else begin
                   PutMap(25,41,0); PutMap(26,41,0);
                end;
             end;
             if at(36,16) then
             if wantenter('베리알의 동굴') then begin
                if party.etc[9] and bit6 = 0 then begin
                   enemynumber := 8;
                   for i := 1 to enemynumber do joinenemy(i,32);
                   Print(7,' 일행이 동굴 입구에 다가서자  무언가 반짝이');
                   Print(7,'는 눈 같은 것이 보였다.');
                   PressAnyKey;
                   DisplayEnemies(TRUE);
                   BattleMode(FALSE,TRUE);
                   if party.etc[6] = 0 then begin
                      with party do begin
                         map := 15; xaxis := 25; yaxis := 44;
                      end;
                      Load;
                   end;
                end
                else begin
                   Print(7,' 하지만 동굴의 입구는 막혀 있어서 들어갈 수');
                   Print(7,'가 없습니다.');
                end;
             end;
             if at(93,6) then
             if wantenter('몰록의 동굴') then begin
                with party do begin
                   map := 16; xaxis := 10; yaxis := 44;
                end;
                Load;
             end;
          end;
      4 : begin
             if at(42,76) then
             if wantenter('공간 이동 게이트') then begin
                x := 13; y := 72;
                Silent_Scroll;
                Clear;
                Print(7,' 일행은 다른 곳으로 이동 되었다.');
                exit;
             end;
             if at(13,71) then
             if wantenter('공간 이동 게이트') then begin
                x := 42; y := 77;
                Silent_Scroll;
                Clear;
                Print(7,' 일행은 다른 곳으로 이동 되었다.');
                exit;
             end;
             if at(41,54) then
             if wantenter('공간 이동 게이트') then begin
                x := 13; y := 72;
                Silent_Scroll;
                Clear;
                Print(7,' 일행은 다른 곳으로 이동 되었다.');
                exit;
             end;
             if at(14,43) then
             if wantenter('아스모데우스의 동굴') then begin
                if (y = 44) and (party.etc[41] and bit7 = 0) then begin
                   enemynumber := 2;
                   joinenemy(1,64); joinenemy(2,65);
                   DisplayEnemies(TRUE);
                   Print(13,' 너희들이 이 동굴에 들어 가겠다고 ?');
                   Print(13,' 우리들은  아스모데우님의 경호를  맡고 있는');
                   Print(13,'가디안 라이트와 가디안 레프트라고 한다.  소');
                   Print(13,'개는 이쯤에서 끝내도록하고 바로 대결을 하도');
                   Print(13,'록하지.');
                   PressAnyKey;
                   enemynumber := 8;
                   for i := 1 to 8 do joinenemy(i,55);
                   joinenemy(4,64); joinenemy(8,65);
                   DisplayEnemies(TRUE);
                   BattleMode(FALSE,TRUE);
                   if party.etc[6] = 0 then begin
                      Clear;
                      Print(13,' 우욱... 하지만 나는 죽더라도 한사람은 지옥');
                      Print(13,'으로 보내 주겠다.');
                      Print(7,'');
                      Print(7,' 가디안 레프트는  죽기 직전에 일행의 뒤에서');
                      Print(7,'거대한 마법 독화살을 쏘았다.');
                      Print(7,'');
                      j := 1;
                      i := player[1].agility;
                      for k := 2 to 6 do begin
                         if player[i].hp > 0 then
                         if player[i].agility <= i then begin
                            j := k;
                            i := player[j].agility;
                         end;
                      end;
                      Print(12,' 가디안 레프트의 마법 독화살은 일행 중 가장');
                      Print(12,'민첩성이 낮은 '+player[j].name+'에게 명중 했다.');
                      Print(12,' 그리고, '+player[j].name+ReturnSJosa(player[j].name)+' 즉사 했다.');
                      with player[j] do begin
                         hp := 0;
                         poison := 1;
                         unconscious := endurance * level * 10 - 2;
                         if unconscious < 1 then unconscious := 1;
                         dead := 1;
                      end;
                      Display_Condition;
                      with party do begin
                         map := 17; xaxis := 25; yaxis := 44;
                      end;
                      Load;
                      party.etc[43] := 0;
                      Silent_Scroll;
                      party.etc[41] := party.etc[41] or bit7;
                   end;
                end
                else begin
                   with party do begin
                      map := 17; xaxis := 25; yaxis := 44;
                   end;
                   Load;
                   party.etc[43] := 0;
                end;
             end;
             if at(9,21) then
             if wantenter('아스모데우스의 동굴') then begin
                with party do begin
                   map := 17; xaxis := 25; yaxis := 7;
                end;
                Load;
                party.etc[43] := 0;
             end;
             if at(27,9) then
             if wantenter('메피스토펠레스의 요새') then begin
                with party do begin
                   map := 18; xaxis := 25; yaxis := 44;
                end;
                Load;
                face := 5;
                move(Font^[46],Font^[55],294);
                for i := 5 to 294 do
                Font^[55][i] := (Font^[55][i] and chara^[face+28][i]) or (chara^[face][i]);
                if party.etc[1] < 10 then party.etc[1] := 10;
                Scroll(FALSE);
                PutImage(120,11*24,Font^[55],CopyPut);
                for i := 10 downto 6 do begin
                   delay(1000);
                   PutImage(120,i*24,Font^[55],CopyPut);
                   PutImage(120,(i+1)*24,Font^[46],CopyPut);
                end;
                for i := 1 to 2 do begin
                   delay(800);
                   dec(y);
                   Silent_Scroll;
                end;
                for i := 24 to 27 do PutMap(i,44,24);
                for j := 45 to 50 do
                for i := 23 to 28 do PutMap(i,j,29);
             end;
          end;
      7 : begin
             Clear;
             Print(7,' 당신이 동굴 입구에 들어가려 할때 어떤 글을');
             Print(7,'보았다.');
             for i := 1 to 3 do Print(7,'');
             Print(15,'   여기는 한때 피라미드라고 불리우는 악   ');
             Print(15,'   마의 동굴이었지만 지금은 폐쇄되어 아   ');
             Print(15,'   무도 들어갈 수가 없습니다.');
          end;
      11: begin
             if at(25,7) or at(26,7) then begin
                Clear;
                Print(7,' 당신이 입구에 들어가려 했지만  이미 입구는');
                Print(7,'함몰 되어 들어 갈 수가 없었다.');
                if not exist(2) then exit;
                if party.etc[31] and bit8 > 0 then exit;
                PressanyKey;
                with player[2] do begin
                   Print(7,' '+name+ReturnSJosa(name)+' 동굴의 입구를 조사하더니 당신에게 말했다');
                   Print(7,'');
                   Print(3,' 잠깐 여기를 보게. 이 입구에 떨어져 있는 흙');
                   Print(3,'은 다른 곳의 흙과는 다르다네. 이 걸 보게나.');
                   Print(3,'모래가 거의 유리처럼 변해있지 않은가. 이 건');
                   Print(3,'분명히 핵 폭발이  여기에서 일어 났었다는 증');
                   Print(3,'거 일세.  이 동굴의 입구가 함몰된 이유는 바');
                   Print(3,'로 핵 무기나 아니면 거기에 필적하는 초 자연');
                   Print(3,'적인  마법에 의해서 인것 같네.  그렇다면 이');
                   Print(3,'동굴 안의 세계에 존재하는 인물 중에서 이 정');
                   Print(3,'도의 고수준 마법을  사용하는 사람이  있다는');
                   Print(3,'셈이라네.');
                end;
                party.etc[31] := party.etc[31] or bit8;
             end;
          end;
      12: begin
             if at(25,28) or at(26,28) then begin
                Clear;
                Print(7,' 당신은 이 동굴에 들어 가려고 했지만 동굴의');
                Print(7,'입구는  어떠한 강한 힘에 의해 무너져 있었고');
                Print(7,'일행들의 힘으로는 도저히 들어갈 방도가 없었');
                Print(7,'다. 결국에 일행은 들어가기를 포기했다.');
                PutMap(25,25,52); PutMap(26,25,52);
             end;
          end;
   end;
   Silent_Scroll;
end;

Procedure Sign;
begin
   while keypressed do c := readkey;
   Clear;
   yline := 30; hany := 16;
   Print(7,'푯말에 쓰여있기로 ...');
   Print(7,''); Print(7,'');
   case party.map of
      2 : begin
             if at(82,101) then begin
                Print(15,'     피라미드의 암흑이 호수 위를 비');
                Print(15,'     출때,  고대 해왔던 잊혀진 유적');
                Print(15,'     은 당신 앞에서  그 진가를 발하');
                Print(15,'     며 불멸의 생명을 안겨 줄것이다');
             end;
             if at(143,116) then begin
                Print(15,'     어서오게, 친구여.  자네가 여기');
                Print(15,'     에 있는 6 가지의 시험을 통과한');
                Print(15,'     다면 영원 불멸의 생명을 영위하');
                Print(15,'     게 될 걸세.');
             end;
             if at(30,100) then begin
                Print(15,'     오!! 현명한자여. 당신은 영원한');
                Print(15,'     생명을 얻을 자격이 있소.  이제');
                Print(15,'     잊혀진 유적은 당신의 의지에 순');
                Print(15,'     응할 것이오.');
                party.etc[44] := party.etc[44] or bit1;
             end;
          end;
      6 : begin
             if at(51,84) then begin
                cPrint(15,11,'         여기는 ','로어성','입니다');
                Print(15,'         여러분을 환영합니다');
                for i := 1 to 3 do Print(7,'');
                Print(13,'               로드 안');
             end;
             if at(24,31) then begin
                Print(7,'');
                Print(15,'             여기는 로어 주점');
                Print(15,'       여러분 모두를 환영합니다 !!');
             end;
             if at(51,18) or at(52,18) then begin
                Print(7,'');
                Print(15,'          로어 왕립  죄수 수용소');
             end;
             if at(77,48) then
                Print(15,'          여기는 로어 은행입니다');
             if at(77,42) then
                Print(15,'       허락 없이 들어가지 마시오 !!');
             if at(77,36) then
                Print(15,'           마법사 베텔규스의 집');
             if at(77,30) then begin
                Print(15,'   지금 집 주인인 저 레굴루스는 여행을');
                Print(15,'   떠나고 없습니다. 저에게 용건이 있으');
                Print(15,'   신분은 북쪽 해안으로 오십시오.');
             end;
             if at(77,24) then
                Print(15,'         여기는 헤라클레스의 집');
          end;
      7 : begin
             if at(39,68) then begin
                cPrint(15,11,'       여기는 ','라스트디치성','입니다');
                Print(15,    '          여러분을 환영합니다');
             end;
             if at(39,8) then Print(12,'        여기는 옛 피라미드 의 입구');
             if at(54,9) then Print(10,'       여기는 그라운드 게이트의 입구');
          end;
      12: begin
             if at(25,41) then begin
                Print(15,'   당신이 지하 세계로 통하는 입구를');
                Print(15,'   열고 싶다면 동굴 속의 4개의 레버');
                Print(15,'   를 모두 당겨 주십시오.');
             end;
          end;
      18: begin
             if at(24,40) then begin
                Print(10,'   반드시 메피스토펠레스를 무찔러 주');
                Print(10,'   시오. 건투를 빌겠소.');
                for i := 1 to 7 do Print(7,'');
                Print(14,'      로드 안과 에인션트 이블로 부터');
             end;
             if at(27,40) then begin
                Print(10,'   역시 나의 게임은 훌륭하지 않소 ?');
                Print(10,'   이제 나의 16 번째 자작 게임의 결');
                Print(10,'   말이 다가오고 있소. 거의 한달 가');
                Print(10,'   까이 만들었었는데...');
                Print(7,'');
                Print(7, '   제작 기간 :  93/12/08 - 94/01/04');
                Print(7,'');
                Print(15,'    동아 대학교 전기 공학과 92 학번');
                Print(15,'        자칭 사상 최고의 프로그래머');
                Print(14,'                      안 영기로부터');
             end;
          end;
   end;
end;

end.