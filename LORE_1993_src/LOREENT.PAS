Unit LoreEnt;

INTERFACE

Uses
   Crt, Graph, UHanX, LoreSub, Voice, LoreBatt, LoreEnd;

 Procedure entermode;
 Procedure sign;


IMPLEMENTATION

Procedure entermode;
begin
   case party.map of
      1 : begin
             if at(20,11) then
             if wantenter('CASTLE LORE') then begin
                with party do begin
                   map := 6; xaxis := 51; yaxis := 95;
                end;
                load;
                map[49,52]:=47; map[50,52]:=44; map[51,52]:=44;
                map[52,52]:=44; map[53,52]:=47; map[49,53]:=47;
                map[50,53]:=44; map[51,53]:=44; map[52,53]:=44; map[53,53]:=45;
                for i := 49 to 53 do map[i,88] := 44;
             end;
             if at(76,57) then
             if wantenter('LASTDITCH') then begin
                with party do begin
                   map := 7; xaxis := 37; yaxis := 70;
                end;
                load;
                for i := 1 to 6 do if player[i].name = 'Polaris' then map[37,41] := 44;
             end;
             if at(17,89) then
             if wantenter('MENACE') then begin
                with party do begin
                   map := 14; xaxis := 25; yaxis := 45;
                end;
                load;
             end;
             if at(20,6) then
             if wantenter('ANOTHER LORE') then begin
                with party do begin
                   map := 27; xaxis := 15; yaxis := 45;
                end;
                load;
             end;
          end;
      2 : begin
             if at(19,26) then
             if wantenter('VALIANT PEOPLES') then begin
                with party do begin
                   map := 8; xaxis := 38; yaxis := 70;
                end;
                load;
             end;
             if at(31,82) then
             if wantenter('GAIA TERRA') then begin
                with party do begin
                   map := 9; xaxis := 26; yaxis := 45;
                end;
                load;
             end;
             if at(82,47) then
             if wantenter('QUAKE') then begin
                with party do begin
                   map := 15; xaxis := 25; yaxis := 70;
                end;
                load;
             end;
             if at(44,7) then
             if wantenter('WIVERN') then begin
                with party do begin
                   map := 16; xaxis := 20; yaxis := 35;
                end;
                load;
             end;
          end;
      3 : begin
             if at(74,19) then
             if wantenter('WATER FIELD') then begin
                with party do begin
                   map := 10; xaxis := 25; yaxis := 70;
                end;
                load;
                if party.etc[38] and bit4 > 0 then map[40,56] := 44;
             end;
             if at(23,62) then
             if wantenter('NOTICE') then begin
                with party do begin
                   map := 17; xaxis := 56; yaxis := 94;
                end;
                load;
             end;
             if at(96,42) then
             if wantenter('LOCKUP') then begin
                with party do begin
                   map := 18; xaxis := 25; yaxis := 94;
                end;
                load;
             end;
          end;
      4 : begin
             if at(48,35) then
             if wantenter('SWAMP KEEP') then begin
                with party do begin
                   map := 21; xaxis := 25; yaxis := 45;
                end;
                load;
             end;
             if at(48,57) then
             if wantenter('EVIL GOD') then begin
                with party do begin
                   map := 19; xaxis := 25; yaxis := 45;
                end;
                load;
             end;
             if at(82,16) then
             if wantenter('MUDDY') then begin
                with party do begin
                   map := 20; xaxis := 25; yaxis := 95;
                end;
                load;
             end;
          end;
      5 : begin
             if at(15,31) then
             if wantenter('IMPERIUM MINOR') then begin
                with party do begin
                   map := 22; xaxis := 25; yaxis := 45;
                end;
                load;
             end;
             if at(34,14) then
             if wantenter('EVIL CONCENTRATION') then begin
                if party.etc[44] and bit1 = 0 then begin
                   enemynumber := 7;
                   for i := 1 to enemynumber do joinenemy(i,54);
                   joinenemy(random(5)+2,69);
                   displayenemies(TRUE);
                   Print(13,' 나는 EVIL CONCENTRATION 성의 입구를 지키는');
                   Print(13,'임무를 맡고 있는 Frost Dragon이다.  내가 지');
                   Print(13,'키고 있는한  너희들은 한 발자국도  들여놓지');
                   Print(13,'않을것이다.');
                   PressAnyKey;
                   battlemode(FALSE);
                   if party.etc[6] > 0 then exit;
                   party.etc[44] := party.etc[44] or bit1;
                end;
                with party do begin
                   map := 23; xaxis := 25; yaxis := 45;
                end;
                load;
             end;
          end;
      7 : if wantenter('PYRAMID') then begin
             with party do begin
                map := 11; xaxis := 25; yaxis := 45;
             end;
             load;
             if party.etc[13] > 1 then begin
                map[25,44] := 50; map[26,44] := 50;
             end;
          end;
      8 : if wantenter('EVIL SEAL') then begin
             with party do begin
                map := 12; xaxis := 25; yaxis := 70;
             end;
             load;
             if party.etc[14] > 1 then map[18,9] := 0;
          end;
      10 : if wantenter('WIVERN') then begin
              with party do begin
                 map := 16; xaxis := 20; yaxis := 9;
              end;
              load;
           end;
      13 : if wantenter('SWAMP KEEP') then begin
              with party do begin
                 map := 21; xaxis := 25; yaxis := 6;
              end;
              load;
           end;
      16 : if wantenter('WATER FIELD') then begin
              with party do begin
                 map := 10; xaxis := 26; yaxis := 8;
              end;
              load;
              if party.etc[38] and bit4 > 0 then map[40,56] := 44;
           end;
      21 : begin
              if y <= 6 then begin
                 if wantenter('SWAMP GATE') then begin
                    with party do begin
                       map := 13; xaxis := 81; yaxis := 68;
                    end;
                    load;
                 end;
              end
              else if wantenter('IMPERIUM MINOR') then begin
                 if not (odd(party.etc[40]) and odd(party.etc[41])) then begin
                    message(7,' 라바 게이트는 작동되지 않았다.');
                    exit;
                 end;
                 if party.etc[42] and bit2 = 0 then begin
                    j := 1;
                    if party.etc[42] and bit5 = 0 then begin
                       joinenemy(j,65);
                       inc(j);
                    end;
                    if party.etc[42] and bit6 = 0 then begin
                       joinenemy(j,64);
                       inc(j);
                    end;
                    if j = 1 then begin
                       party.etc[42] := party.etc[42] or bit2;
                    end
                    else begin
                       enemynumber := j-1;
                       DisplayEnemies(TRUE);
                       BattleMode(FALSE);
                       if enemy[1].dead then party.etc[42] := party.etc[42] or bit5;
                       if enemy[2].dead then party.etc[42] := party.etc[42] or bit6;
                       if enemy[1].dead and enemy[2].dead then
                          party.etc[42] := party.etc[42] or bit2;
                    end;
                 end;
                 with party do begin
                    map := 22; xaxis := 25; yaxis := 6;
                 end;
                 Clear;
                 if party.etc[42] and bit7 = 0 then begin
                    enemynumber := 1;
                    joinenemy(1,68);
                    displayenemies(TRUE);
                    Print(7,' 역시 당신들은 나의 예상대로 마지막  대륙까');
                    Print(7,'지 무난하게 왔군요. 이번에 가게될 LAVA 대륙');
                    Print(7,'은 이 세계에 있는 모든 대륙중에서 가장 작은');
                    Print(7,'대륙이오. 적의 요새도 또한 2개 밖에 없는 곳');
                    Print(7,'이오. 하지만 이번에 도착할 IMPERIUM MINOR나');
                    Print(7,'마지막으로 거칠 EVIL CONCENTRATION 은 말 그');
                    Print(7,'대로 악의 집결지인 것이오.  거기에는 최강의');
                    Print(7,'괴물들과 Necromancer 의 심복들로 가득차있는');
                    Print(7,'곳이지만 IMPERIUM MINOR의 지하에는 마지막으');
                    Print(7,'로 살아남은 사람들의 도시가 있소. 원래 거기');
                    Print(7,'는 Ancient Evil이 전에 세운 악의 동굴이었지');
                    Print(7,'만 Necromancer의 침략으로 지상의 도시가  함');
                    Print(7,'락되자 그 곳의 사람들은 모두 거기로 피난 했');
                    Print(7,'던 것이고 거기는 Ancient Evil의 영적인 힘으');
                    Print(7,'로 보호되고 있어서 적들이 침략을하지 못하는');
                    Print(7,'이유가 되지요.  그러므로 모든 도움과 물자는');
                    Print(7,'거기서 받도록하시오.');
                    Print(7,' 그러면, 나는 당신이 Necromancer와 상대하게');
                    Print(7,'될 때 다시 Ancient Evil과 같이 나타나겠소.');
                    talk('');
                    party.etc[42] := party.etc[42] or bit7;
                 end;
                 load;
              end;
           end;
      22 : begin
              if y <= 6 then begin
                 if wantenter('SWAMP KEEP') then begin
                    with party do begin
                       map := 21; xaxis := 25; yaxis := 20;
                    end;
                    load;
                 end;
              end
              else begin
                 if wantenter('LAST SHELTER') then begin
                    with party do begin
                       map := 24; xaxis := 25; yaxis := 45;
                    end;
                    load;
                    if party.etc[43] and bit4 > 0 then map[33,10] := 47;
                 end;
              end;
           end;
      23 : if wantenter('DUNGEON OF EVIL') then begin
              if party.etc[44] and bit2 = 0 then begin
                 enemynumber := 7;
                 for i := 1 to 7 do joinenemy(i,62);
                 joinenemy(3,70);
                 displayenemies(TRUE);
                 Print(13,' 이 동굴에 들어 가겠다고?');
                 Print(13,' 하!, 우습군. 너희들에게는 여기의 Draconian');
                 Print(13,'족들의 모습이 보이지 않는 모양이군.');
                 PressAnyKey;
                 if player[6].name = 'Draconian' then begin
                    Print(7,' ArchiDraconian은 마지막에 있는 Draconian');
                    Print(7,'을 발견했다.');
                    Print(13,' 아니 너는 누구냐! 감히 Draconian 족이면');
                    Print(13,'서 Necromancer님에게 반기를 들다니... 그');
                    Print(13,'것은 바로 죽음이다. 받아랏!!');
                    with player[6] do begin
                       hp := 0;
                       unconscious := 1;
                       dead := 30000;
                    end;
                    if soundon then begin
                       hit; hit;
                       delay(500); hit;
                    end;
                    SimpleDisCond;
                    PressAnyKey;
                 end;
                 battlemode(FALSE);
                 if not enemy[3].dead then begin
                    scroll(TRUE);
                    exit;
                 end;
                 party.etc[44] := party.etc[44] or bit2;
              end;
              with party do begin
                 map := 25; xaxis := 25; yaxis := 45;
              end;
              load;
           end;
      25 : if wantenter('CHAMBER OF NECROMANCER') then begin
              party.etc[1] := 1;
              Silent_Scroll;
              i := 0; j := 0;
              for k := 1 to 10 do begin
                 if k > 1 then
                    putimage(100+i*20,100+j*20,font^[map[x+i,y+j]],copyput);
                 i := random(9)-4; j := random(9)-4;
                 if (i=0) and (j=0) then j := -1;
                 putimage(100+i*20,100+j*20,chara^[50],andput);
                 putimage(100+i*20,100+j*20,chara^[22],orput);
                 delay(1000);
              end;
              Print(13,' 두말이 필요없다. 덤벼라 !!');
              PressAnyKey;
              enemynumber := 6;
              for i := 1 to 5 do joinenemy(i,63);
              joinenemy(6,72);
              displayenemies(TRUE);
              battlemode(TRUE);
              if party.etc[6] = 255 then exit;
              if party.etc[6] > 0 then begin
                 x := 25; y := 45;
                 scroll(TRUE);
                 exit;
              end;
              with party do begin
                 map := 26; xaxis := 25; yaxis := 15;
              end;
              load;
              scroll(FALSE);
              face := 5;
              for j := 4 downto 0 do begin
                 if j < 4 then
                    putimage(100,120+j*20,font^[map[x,y+j+1]],copyput);
                 putimage(100,100+j*20,chara^[33],andput);
                 putimage(100,100+j*20,chara^[5],orput);
                 delay(1000);
              end;
              for j := 16 to 19 do
              for i := 24 to 26 do map[i,j] := 16;
              scroll(TRUE);
           end;
   end;
   scroll(TRUE);
end;

Procedure sign;
begin
   while keypressed do c := readkey;
   Clear;
   for i := 0 to 1 do begin
      yline := 30; hany := 16;
      page := 1 - page;
      setactivepage(page);
      Print(7,'푯말에 쓰여있기로 ...');
      Print(7,''); Print(7,'');
      case party.map of
         2 : begin
                if at(31,44) then Print(15,'          WIVERN 가는길');
                if at(29,50) or at(35,72) then begin
                   Print(15,'  북쪽 :');
                   Print(15,'       VALIANT PEOPLES 가는길');
                   Print(15,'  남쪽 :');
                   Print(15,'       GAIA TERRA 가는길');
                end;
                if at(44,77) then begin
                   Print(15,'  북동쪽 :');
                   Print(15,'       QUAKE 가는길');
                   Print(15,'  남서쪽 :');
                   Print(15,'       GAIA TERRA 가는길');
                end;
             end;
         6 : begin
                if at(51,84) then begin
                   cPrint(15,11,'       여기는 `','CASTLE LORE','''성');
                   Print(15,'         여러분을 환영합니다');
                   setcolor(13);
                   outtextxy(360,140,'Lord Ahn');
                end;
                if at(24,31) then begin
                   Print(7,'');
                   Print(15,'             여기는 LORE 주점');
                   Print(15,'       여러분 모두를 환영합니다 !!');
                end;
                if at(51,18) or at(52,18) then begin
                   Print(7,'');
                   Print(15,'          LORE 왕립  죄수 수용소');
                end;
             end;
         7 : begin
                if at(39,68) then begin
                   cPrint(15,11,'        여기는 `','LASTDITCH','''성');
                   Print(15,'         여러분을 환영합니다');
                end;
                if at(39,8) then Print(12,'       여기는 PYRAMID 의 입구');
                if at(54,9) then Print(10,'     여기는 GROUND GATE 의 입구');
             end;
         8 : begin
                if at(39,67) then begin
                   cPrint(15,11,'      여기는`','VALIANT PEOPLES','''성');
                   Print(15,'    우리의 미덕은 굽히지 않는 용기');
                   Print(15,'   우리는 어떤 악에도 굽히지 않는다');
                end
                else Print(12,'     여기는 EVIL SEAL 의 입구');
             end;
         9 : begin
                if at(24,26) then Print(15,'       여기는 국왕의 보물 창고')
                else begin
                   cPrint(15,11,'         여기는 `','GAIA TERRA','''성');
                   Print(15,'          여러분을 환영합니다');
                end;
             end;
         12 : begin
                 if at(24,68) then Print(15,'               X 는 7');
                 if at(27,68) then Print(15,'               Y 는 9');
                 if at(25,63) then Print(15,'       바른 문의 번호는 X + Y');
                 if y+y1 = 56 then begin
                    j := (x+x1-6) div 7 + 12;
                    str(j,s);
                    cPrint(15,11,'           문의 번호는 ''',s,'''');
                 end;
                 if at(26,42) then Print(15,'            Z 는 2 * Y + X');
                 if at(26,33) then begin
                    Print(15,'        패스코드 x 패스코드 는 Z 라면');
                    Print(7,'');
                    Print(15,'            패스코드는 무엇인가 ?');
                 end;
                 if y+y1 = 29 then begin
                    j := (x+x1-3) div 5 + 2;
                    str(j,s);
                    cPrint(15,11,'           패스코드는 ''',s,'''');
                 end;
              end;
         15 : begin
                 Print(7,'');
                 if at(26,63) then Print(15,'            길의 마지막');
                 if at(22,15) then Print(15,'     (12,15) 로 공간이동 하시오');
                 if at(11,14) then Print(15,'     (13,7) 로 공간이동 하시오');
                 if at(27,14) then Print(15,'   황금의 갑옷은 (45,19) 에 숨겨져있음');
              end;
         17 : begin
                 Print(7,'');
                 if at(68,47) then Print(15,'    하! 하! 하!  너는 우리에게 속았다');
                 if at(58,53) then begin
                    Print(10,'      이 게임을 만든 사람');
                    Print(15,'  : 동아 대학교 전기 공학과');
                    Print(15,'        92 학번  안 영기');
                 end;
                 if at(51,30) then begin
                    Print(15,'       오른쪽 : Hidra 의 보물창고');
                    Print(15,'       왼  쪽 : Hidra 가 있는 방');
                 end;
                 if at(66,13) then Print(15,'     일찌감치 이 곳 탐험을 포기해라');
                 if at(9,28) then Print(15,'         위쪽이 진짜 보물창고임');
              end;
         19 : begin
                 Print(15,'       이 길을 통과하고자하는 사람은');
                 Print(15,'     양측의 늪속에 있는 레버를 당기시오');
              end;
         23 : begin
                 Print(15,'      (25,27)에 있는 레버를 움직이면');
                 Print(15,'          성을 볼수 있을 것이오.');
                 Print(7,'');
                 Print(10,'             제작자 안 영기 씀');
                 map[25,27] := 52;
              end;
      end;
   end;
end;

begin
end.