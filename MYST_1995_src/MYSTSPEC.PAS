Unit MystSpec;
{$O+,F+}
INTERFACE

Uses
   Crt, Graph, UHanX, MystSub, Voice, MystBatt, MystEnd;

 Procedure SpecialEvent;


IMPLEMENTATION


Procedure Plus_Ability_Sub(st : string);

const
   Price_Data_Sub : array[1..30] of longint = (
                30,60,125,250,500,1000,2000,3000,4000,6000,
                8000,12000,16000,24000,32000,64000,96000,128000,192000,256000,
                384000,512000,770000,1000000,1500000,2000000,2500000,3000000,350000,4000000);
var
   price_data : array[1..30] of longint;
   max, ability : byte;
   k : integer;
begin
   Print(7,' 당신은 나의 문제를 모두 맞추었소.  그 보답');
   Print(7,'으로,  당신이 황금을 나에게 바친다면 당신들');
   Print(7,'중의 한사람의 '+st+'을 한 단계 올려 주겠소.');
   k := ChooseWhomSub(130,FALSE,FALSE);
   if k = 0 then exit;
   if st = '정신력' then begin
                    max := 30;
                    ability := player[k].mentality;
                    for i := 1 to max do price_data[i] := Price_Data_Sub[i];
   end;
   if st = '인내력' then begin
                    max := 30;
                    ability := player[k].endurance;
                    for i := 1 to max do price_data[i] := Price_Data_Sub[i];
   end;
   if st = '체력' then begin
                    max := 30;
                    ability := player[k].strength;
                    for i := 1 to max do price_data[i] := Price_Data_Sub[i];
   end;
   if st = '민첩성' then begin
                    max := 20;
                    ability := player[k].agility;
                    for i := 1 to max do price_data[i] := Price_Data_Sub[i];
   end;
   if st = '정확성' then begin
                    max := 20;
                    ability := player[k].accuracy;
                    for i := 1 to max do price_data[i] := Price_Data_Sub[i+1]
   end;
   with player[k] do begin
      if ability >= max then begin
         Print(7,name+ReturnSJosa(name)+' 지금 최고의 '+st+' 수치입니다.');
         exit;
      end;
      if party.gold < price_data[succ(ability)] then begin
         str(price_data[succ(ability)],s);
         Print(7,'일행은 '+s+' 개의 황금이 필요합니다.');
         exit;
      end;
      inc(ability);
      party.gold := party.gold - price_data[ability];
      str(ability,s);
      Print(15,name+ReturnSJosa(name)+'의 '+st+'은 이제 '+s+'입니다.');
   end;
   if st = '정신력' then player[k].mentality := ability;
   if st = '인내력' then player[k].endurance := ability;
   if st = '체력' then player[k].strength := ability;
   if st = '민첩성' then player[k].agility := ability;
   if st = '정확성' then player[k].accuracy := ability;
end;

Procedure Plus_Mentality;
begin
   Plus_Ability_Sub('정신력');
end;
Procedure Plus_Endurance;
begin
   Plus_Ability_Sub('인내력');
end;

Procedure Plus_Strength;
begin
   Plus_Ability_Sub('체력');
end;

Procedure Plus_Agility;
begin
   Plus_Ability_Sub('민첩성');
end;

Procedure Plus_Accuracy;
begin
   Plus_Ability_Sub('정확성');
end;

Procedure Find_Gold(bit : byte; value : longint);
begin
   if not getbit(bit) then begin
      findgold(value);
      setbit(bit);
   end;
end;

Procedure Find_Item(var param : byte; bit, item_number, value : byte);
const
   data : array[1..10] of string[15] = (
             '체력 회복약을','마법 회복약을','해독의 약초를',
             '의식의 약초를','부활의 약초를','소환 문서를',
             '대형 횃불을','수정 구슬을','비행 부츠를','이동 구슬을');
begin
   if param and bit = 0 then begin
      Clear;
      str(value,s);
      Print(7,'일행은 '+data[item_number]+' '+s+'개 발견했다.');
      if party.item[item_number] + value < 256 then
         party.item[item_number] := party.item[item_number] + value
      else
         party.item[item_number] := 255;
      param := param or bit;
   end;
end;

Function sgn(eq : integer) : integer;
begin
   if eq > 0 then sgn := 1
   else if eq < 0 then sgn := -1
   else sgn := 0;
end;

Function Random_Order(max_no : byte) : boolean;
var
   data : array[0..10] of byte;
   temp, swap : byte;
   i,k : integer;
   aux_m : array[0..10] of string[50];
begin
   for i := 0 to max_no do data[i] := i;
   for i := max_no downto 1 do begin
      temp := random(max_no) + 1;
      swap := data[i];
      data[i] := data[temp];
      data[temp] := swap;
   end;
   move(m,aux_m,sizeof(m));
   for i := 1 to max_no do m[i] := aux_m[data[i]];
   k := Select(180,max_no,max_no,FALSE,TRUE);
   if data[k] = max_no then
      Random_Order := TRUE
   else
      Random_Order := FALSE
end;

Procedure SpecialEvent_Sub1;
begin

   scroll(TRUE);

   if mapname = 'Ground1' then begin
      if on(30,20) and (not getbit(51)) then begin
         Clear;
         enemynumber := 7;
         joinenemy(1,36);
         enemy[1].name := '폴록스';
         for i := 2 to 7 do begin
            joinenemy(i,34);
            enemy[i].name := '강도';
         end;
         DisplayEnemies(TRUE);
         Print( 7,' 당신이 길을 가던 도중에 갑자기 강도가 나타');
         Print( 7,'났다.  그리고 제일 앞에 있는 여자 강도가 말');
         Print( 7,'을 꺼냈다.');
         Print( 7,'');
         Print(13,' 이런 곳에 겁도 없이 돌아다니다니, 하하하.');
         Print(13,' 우리 7 명의 능력을 당해내지 못할 것 같으면');
         Print(13,'순순히 가진 돈을 다 내놓아라.');
         setbit(51);
         m[0] := '';
         m[1] := '가진 돈을 모두 준다';
         m[2] := '선제 공격을 가한다';
         if Select(190,2,2,FALSE,TRUE) = 1 then begin
            party.gold := 0;
            Scroll(TRUE);
            Print(7,' 당신은 강도에게 모든 돈을 빼았겼다.');
            exit;
         end;
         BattleMode(TRUE,TRUE);
         if party.etc[6] = 254 then exit;
         if party.etc[6] = 2 then begin
            Silent_Scroll;
            exit;
         end;
         Clear;
         Print(13,' 윽!! 나의 패배를 인정하겠다.  나는 원래 암');
         cPrint(13,11,'살자로 일하던 ','폴록스','라고한다. 수련을 목적으');
         Print(13,'로 당신과 동행하고 싶다. 당신은 어떤가?');
         m[0] := '';
         m[1] := '좋소, 허락하겠소';
         m[2] := '그렇게는 않되오';
         if Select(150,2,2,FALSE,TRUE) = 1 then begin
            k := 0;
            repeat
               inc(k);
            until (player[k].name = '') or (k = 6);
            if k < 6 then begin
               with player[k] do begin
                  name := '폴록스';
                  sex := female;
                  class := 6;
                  classtype := sword;
                  level := 5;
                  strength := 15;
                  mentality :=19;
                  concentration := 20;
                  endurance := 11;
                  resistance := 18;
                  agility := 20;
                  accuracy := 17;
                  luck := 10;
                  poison := 0;
                  unconscious := 0;
                  dead := 0;
                  hp := 1;
                  sp := 0;
                  experience := 0;
                  potential_experience := ReturnEXP(level);
                  weapon := 18;
                  shield := 0;
                  armor := 1;
                  potential_ac := 2;
                  sword_skill := 10;
                  axe_skill := 0;
                  spear_skill := 35;
                  bow_skill := 10;
                  shield_skill := 0;
                  fist_skill := 20;
                  Modify_Item(k);
                  setbit(45);
                  Silent_Scroll;
                  Display_Condition;
                  Clear;
               end;
            end
            else begin
               Print(7,' 벌써 사람이 모두 채워져 있군.  다음 기회를');
               Print(7,'를 기다리지.');
               exit;
            end;
         end
         else asyouwish;
      end;
      if on(84,86) then begin
         if party.year > 699 then exit;
         if wantenter('하데스 게이트') then begin
            mapname := 'HdsGate';
            Load;
            Scroll(TRUE);
            exit;
         end;
      end;
   end;

   if mapname = 'Lore' then begin
      if on(44,10) and (party.etc[20] = 0) then begin
         for i := 9 downto 7 do begin
            if (i+1) <= 9 then PutTile(i+1,6,44);
            PutTile(i,6,53);
            delay(1000);
         end;
         Clear;
         Print(9,' 어이, '+player[1].name+'. 로드안님이 널 찾으신다. 따라와!');
         PressAnyKey;
         PutTile(6,6,44);
         delay(2000);
         j := 2; if player[1].classtype = magic then inc(j,8);
         for i := 6 to 10 do begin
            if i < 10 then PutTile(i,6,44);
            PutTile(i-1,6,44);
            if i < 9 then PutTile(i+1,6,53);
            if i < 10 then PutSprite(i,6,j);
            delay(800);
         end;
         Delete_Scroll_Screen;
         delay(2000);
         x := 51; y := 31;
         aux := soundon;
         soundon := FALSE;
         Scroll(FALSE);
         soundon := aux;
         b := 1; if player[1].classtype = magic then inc(b,8);
         for k := 11 downto 6 do begin
            if (k+1) <= 11 then begin
               PutTile(4,k+1,i); PutTile(5,k+1,j);
            end;
            i := Real_Map(50,k+25); j := Real_Map(51,k+25);
            PutSprite(4,k,13); PutSprite(5,k,b);
            delay(700);
         end;
         s := ReturnBJosa(player[1].name);
         if s <> '이' then s := '';
         Print(10,' 음.. 당신이 '+player[1].name+s+'라는 사람이오?');
         Print(10,' 내가 당신을 특별히 부른 이유는  다름이 아');
         Print(10,'니라  당신을 특별 사면 시켜주려는 의도에서');
         Print(10,'라오.');
         PressAnyKey;
         Print(10,' 당신이  살인 죄로 잡혀오기 전까지는  주위');
         Print(10,'사람들에게 매우 인정받은 용감한 사람이었다');
         Print(10,'는 것을 알고 있소.  내가 지금 부탁하는  몇');
         Print(10,'가지를 들어 준다면 당신에게 그 댓가로 자유');
         Print(10,'로운 삶을 보장하겠소.');
         PressAnyKey;
         for k := 7 to 12 do begin
            PutTile(4,k-1,i);
            i := Real_Map(50,k+25);
            if k < 12 then PutSprite(4,k,13);
            delay(700);
         end;
         Print(7,' 674년 1월 17일 날, 로어 세계에서는 커다란');
         Print(7,'참변이 있었소. 당신은 이전에도 인류와 타종');
         Print(7,'족간에 사이가 않좋았다는 것을 기억 할 거요.');
         Print(7,'또한  사소한 영토분쟁이 많았던 것도 사실이');
         Print(7,'오.  그런데 바로 이날 수백년의 역사를 지님');
         Print(7,'아프로디테 테라의 베스퍼성이 트롤족에 의해');
         Print(7,'완전히 함락 당했던 것이오. 거기서 가까스로');
         Print(7,'탈출한 사람들의 말을 빌면 그 날 베스퍼성은');
         Print(7,'처절한 절규와  아비규환 속에서  아이들이나');
         Print(7,'부녀자 할것없이 모두 처참히 죽어 갔다고 하');
         Print(7,'오.  트롤족은 시체가 즐비한 거리에서  환각');
         Print(7,'작용제를 맞으며  광적인 살인을 계속 해대었');
         Print(7,'다고 하는 탈출자의 말을 듣고  나는 분을 참');
         Print(7,'지 못해 모든 성주들을 불러서 타종족과의 전');
         Print(7,'쟁을 결의 했소. 이렇게 함으로서 베스퍼성에');
         Print(7,'서 죽어간 사람들의 원혼을 달래 주려는 의도');
         Print(7,'라오.');
         Print(7,'');
         PressAnyKey;
         party.etc[20] := 2;
         setbit(0);
      end;
      if on(46,10) and (not(getbit(35) or getbit(50))) then begin

         k := 0;
         repeat
            inc(k);
         until (player[k].name = '') or (k = 6);
         if k >= 6 then exit;

         for i := 1 to 3 do begin
            if (i-1) >= 1 then PutTile(i-1,6,44);
            PutTile(i,6,53);
            delay(500);
         end;
         Clear;
         Print(9,' '+player[1].name+'.');
         Print(9,' 나도 역시 자네처럼 베스퍼성으로 가고 싶네.');
         Print(9,'이런 감옥에서 평생을 지내느니 한 번 모험을');
         Print(9,'해보는게 좋을 것 같아서 말이지.  나는 전사');
         Print(9,'로서의 교육도 받았으니 아마 자네 일원 중에');
         Print(9,'서는 가장 전투력이 뛰어날 걸세.');
         m[0] := '';
         m[1] := '역시 카노푸스 자네 뿐이야';
         m[2] := '자네 도움까지는 필요 없다네';
         if Select(200,2,2,FALSE,TRUE) = 1 then begin
            for i := 8 downto 5 do begin
               PutTile(i+1,7,44);
               PutTile(i,7,53);
               delay(1500);
            end;
            Print(7,' 그렇다면 카노푸스도 당신과 같은 목적을 가');
            Print(7,'진다는 이유로  사면 시켜 달라는  애기군요.');
            Print(7,'그럼 로드안 님에게 물어보고 오겠습니다.');
            PressAnykey;
            for i := 6 to 10 do begin
               PutTile(i-1,7,44);
               if i < 10 then PutTile(i,7,53);
               delay(500);
            end;
            Delete_Scroll_Screen;
            Print(7,' 그로부터 30분이 지났다.');
            PlusTime(0,30,0);
            PressAnyKey;
            Scroll(TRUE);
            PutTile(3,6,53);
            for i := 9 downto 5 do begin
               if (i+1) <= 9 then PutTile(i+1,7,44);
               PutTile(i,7,53);
               delay(1000);
            end;
            Print(7,' 카노푸스를 풀어줘도 좋다고  로드안님이 허');
            Print(7,'락하셨습니다. 정말 희안한 일입니다. 예전에');
            Print(7,'는 전혀 없던 일인데 ... 어쨌든 카노푸는 이');
            Print(7,'제 자유의 몸입니다.');
            PressAnyKey;
            PutTile(4,6,44);
            delay(1000);
            PutTile(3,6,44);
            PutTile(4,6,53);
            delay(1000);
            PutTile(4,6,44);

            k := 0;
            repeat
               inc(k);
            until (player[k].name = '') or (k = 6);
            if k < 6 then begin
               with player[k] do begin
                  name := '카노푸스';
                  sex := male;
                  class := 7;
                  classtype := sword;
                  level := 5;
                  strength := 19;
                  mentality := 6;
                  concentration := 4;
                  endurance := 18;
                  resistance := 17;
                  agility := 20;
                  accuracy := 17;
                  luck := 12;
                  poison := 0;
                  unconscious := 0;
                  dead := 0;
                  hp := endurance * level * 10;
                  sp := 0;
                  experience := 0;
                  potential_experience := ReturnEXP(level);
                  weapon := 0;
                  shield := 0;
                  armor := 0;
                  potential_ac := 2;
                  sword_skill := 20;
                  axe_skill := 10;
                  spear_skill := 5;
                  bow_skill := 0;
                  shield_skill := 50;
                  fist_skill := 10;
                  Modify_Item(k);
                  PutMap(41,10,44);
                  setbit(35);
                  Display_Condition;
                  Clear;
               end;
            end;
            for i := 6 to 9 do begin
               PutTile(i-1,7,44);
               PutTile(i,7,53);
               delay(500);
            end;
            Silent_Scroll;
         end
         else begin
            for i := 2 downto 0 do begin
               PutTile(i+1,6,44);
               if i > 0 then PutTile(i,6,53);
               delay(1000);
            end;
         end;
      end;
      if y = 95 then begin
         if wantexit then DefaultExit
         else begin
            dec(y);
            Silent_Scroll;
         end;
      end;
   end;

   if mapname = 'LastDtch' then begin
      if y = 70 then begin
         if wantexit then DefaultExit
         else begin
            dec(y);
            Silent_Scroll;
         end;
      end;
   end;

   if mapname = 'Menace' then begin
      if on(14,27) then Find_Gold(138,1000);
      if on( 6,39) then Find_Gold(139,1500);
      if on(42,36) then Find_Gold(140,2000);
      if on(44,41) then Find_Gold(141, 500);
      if on(27, 6) then begin
         Clear;
         Print(7,' 당신은 여기서 밀랍으로 봉인된 작은 상자를');
         Print(7,'발견하였다. 조심해서 열어보니 예언서 한 권');
         Print(7,'이 그 속에 들어 있었다.');
         Print(7,' 당신은 호기심에 그 책을 펼쳤다.');
         PressAnyKey;
         Print(14,'INDEX :');
         Print(7,'');
         Print(15,'  Chapter 1. 지식의 성전');
         Print(15,'  Chapter 2. 다크메이지의 탄생');
         Print(15,'  Chapter 3. 제작자의 차원');
         Print(15,'  Chapter 4. 위선자의 최후');
         Print(15,'  Chapter 5. 이 예언의 결말');
         PressAnyKey;
         Print(15,'Chapter 1.');
         Print(7,'');
         cPrint(7,11,' 약 150년 뒤, 지식의 성전의 북쪽 해안에 ','또','');
         cPrint(11,7,'다른 지식의 성전','이라는 피라미드가 생긴다.','');
         Print(7,'그곳에서는 이 세계의 진실된 의미를 발견 할');
         Print(7,'수 있게 될 것이며  ''또 다른 지식의 성전''이');
         Print(7,'라는 뜻을 이해 할 수 있게 할 것이다.');
         PressAnyKey;
         Print(7,' 당신이 다음 장을 넘겼지만 Chapter 2.의 내');
         Print(7,'용은 누군가에 의하여 찢겨져 나갔다.');
         PressAnyKey;
         Print(15,'Chapter 3.');
         Print(7,'');
         Print(7,' 이곳 3차원에서 4차원의 축으로 조금만 이동');
         Print(7,'하면  전혀 다른 새로운 3차원의 세계가 펼쳐');
         Print(7,'진다.  대부분은 텅 빈 공간 속이거나 생명체');
         Print(7,'가 없는 거대한 땅덩이가 있기도 하지만 때때');
         Print(7,'로 생명체가 있는 곳일 수도 있다.  그 중 하');
         cPrint(7,11,'나는 자신의 별을 스스로 ','지구','라고 부르는 종');
         Print(7,'족이 사는 곳이 있다. 그곳에는 이 공간의 창');
         Print(7,'조자인 안영기님이  지금도 열심히 게임 시나');
         Print(7,'리오와 시스템을 구상하고 있을 것이다.');
         PressAnyKey;
         Print(15,'Chapter 4.');
         Print(7,'');
         Print(7,' 795년 위선자는 사라지고  로어 세계는 진정');
         Print(7,'한 평화의 길로 접어든다.  이후의 세계는 안');
         Print(7,'영기님이 창조하지 않아도  우리 스스로가 미');
         Print(7,'래를 개척해 나가게 되고,  안영기님 역시 로');
         Print(7,'어 세계에 대한 일들을 우리에게 모두 위임하');
         Print(7,'고 더 이상 로어 역사에 개입하지 않게 된다.');
         PressAnyKey;
         Print(15,'Chapter 5.');
         Print(7,'');
         Print(7,' 795년 이후의 미래는 더 이상 창조되지 않는');
         Print(7,'다. 그때부터는 우리 스스로가 개척해 나가는');
         Print(7,'미래가 있을 뿐이다.  그리고  나의 예언서도');
         Print(7,'이것으로 끝을 맺게 된다.');
         PressAnyKey;
         Print(7,' 그리고 마지막 장에 이렇게 써 있었다.');
         Print(7,'');
         Print(15,' 이 책은 내가 죽은 다음 날');
         Print(15,'              세상에 나타 날 것이다.');
      end;
      if y = 45 then
      if getbit(0) then begin
         if wantexit then DefaultExit
         else begin
            dec(y); Scroll(TRUE);
         end;
      end
      else begin
         Clear;
         Print(7,' 당신이 광산을 나가려 했을때  당신은  당신');
         Print(7,'앞에 벌어져 있는 광경을 보고 섬뜩함을 느꼈');
         Print(7,'다. 조금 전에 당신에게 일당을 주었던 그 광');
         Print(7,'산업자가 창에 찔린 채로 쓰러져 있었다.  당');
         Print(7,'신은 그 자에게로 다가갔다.  그는 창으로 심');
         Print(7,'장을 관통 당한채 쓰러져 있었다. 나는 그 창');
         Print(7,'이 낯에 익어서 그 창을 뽑아 쥐었다.  그 창');
         Print(7,'은 바로 내가 사냥용으로 쓰던 나의 창이었다.');
         PressAnyKey;
         party.etc[1] := 10;
         Silent_Scroll;
         for k := 11 downto 7 do begin
            if (k+1) <= 11 then begin
               PutTile(5+25-x,k+1,i); PutTile(6+25-x,k+1,j);
            end;
            i := map^[25,k+39]; j := map^[26,k+39];
            PutSprite(5+25-x,k,13); PutSprite(6+25-x,k,13);
            delay(500);
         end;
         Print(7,' 갑자기 나타난 로어성의 병사들은 당신의 창');
         Print(7,'을 빼앗아 들고 말했다.');
         Print(7,'');
         Print(9,' 우리는 당신을 살인 혐의로 체포합니다.  그');
         Print(9,'리고 이 창은 증거물로 압수 하겠습니다.  변');
         Print(9,'명은 법정에서 하십시요.');
         PressAnyKey;
         Delete_Scroll_Screen;
         mapname := 'Lore';
         Load;
         x := 51; y := 31;
         aux := soundon;
         soundon := FALSE;
         Scroll(FALSE);
         soundon := aux;
         b := 1; if player[1].classtype = magic then inc(b,8);
         for k := 11 downto 6 do begin
            if (k+1) <= 11 then begin
               PutTile(4,k+1,i); PutTile(5,k+1,42); PutTile(6,k+1,j);
            end;
            i := Real_Map(50,k+25); j := Real_Map(52,k+25);
            PutSprite(4,k,13); PutSprite(5,k,b); PutSprite(6,k,13);
            delay(700);
         end;
         Print(7,' 로드안이 병사에게 말했다.');
         Print(7,'');
         Print(10,' 이 자는 누구인데 여기로 끌고 왔소?');
         PressAnyKey;
         Print(9,' 이 자는 여기 이 창으로 광산업자를 찔러 죽');
         Print(9,'였습니다.  우리 둘이 공교롭게도 이 자가 그');
         Print(9,'를 찔렀던 이 창을 뽑아내는 것을 목격하고는');
         Print(9,'즉시 체포 했습니다. 우리들의 경해로는 광산');
         Print(9,'업자와의 금전 관계로 인해  저질러진 살인이');
         Print(9,'라고 보아집니다.');
         Print(9,' 그리고 이 창을 증거물로 제시하겠습니다.');
         for k := 5 downto 4 do begin
            if (k+1) <= 6 then PutTile(4,k+1,i);
            i := Real_Map(50,k+25);
            PutSprite(4,k,13);
            delay(1000);
         end;
         delay(1000);
         for k := 5 to 6 do begin
            if (k-1) >= 4 then PutTile(4,k-1,i);
            i := Real_Map(50,k+25);
            PutSprite(4,k,13);
            delay(1000);
         end;
         PressAnyKey;
         Print(7,' 로드안이 말했다.');
         Print(7,'');
         Print(10,' 당신은 이곳의 법률을 알고 있겠지요?  범죄');
         Print(10,'없는 평화로운 세상을 만들기 위해  살인자는');
         Print(10,'모두 사형 또는 종신형에 처한다는 것도 알고');
         Print(10,'있을거요. 당신은 전과가 없기 때문에 사형을');
         Print(10,'선고하지는 않겠소.  그렇지만 최대한 자비를');
         Print(10,'베풀어도 종신형은 면치 못할 꺼요.');
         PressAnyKey;
         Delete_Scroll_Screen;
         x := 39; y := 10;
         Silent_Scroll;
         delay(2000);
         i := map^[x+2,y];
         j := map^[x+1,y];
         map^[x+2,y] := j;
         map^[x+1,y] := i;
         Silent_Scroll;
         Print(9,' 나의 동료가 한 명 생겼군.  나는 1년 반 전');
         cPrint(9,11,'에 절도 상해 혐의로  종신형을 선고 받은 ','카','');
         cPrint(11,9,'노푸스','라고 하네.  우리는 같이 평생을 살 동','');
         Print(9,'료이니 잘 지내도록 하지.');
         PressAnyKey;
         Delete_Scroll_Screen;
         delay(2000);
         map^[x+2,y] := i;
         map^[x+1,y] := j;
         with party do begin
            year := 674; day := 18; hour := 8; min := 0; sec := 0;
         end;
         Silent_Scroll;
         Print(7,' 때는 674년 1월 19일.  당신은 여기서 약 두');
         Print(7,'달을 지냈다.');
      end;
   end;

   if mapname = 'Valiant' then begin
      if y = 70 then begin
         if wantexit then DefaultExit
         else begin
            dec(y);
            Silent_Scroll;
         end;
      end;
   end;

   if mapname = 'Ground2' then begin
      if on(30,47) and (not getbit(51)) and (not getbit(50)) then begin
         Clear;
         Print(7,' 당신은 길을 가던 중  매우 지친듯이 보이는');
         Print(7,'한 여행자를 만났다. 그는 내가 베스퍼성으로');
         Print(7,'간다는 말을 듣더니 이렇게 말했다.');
         PressAnyKey;
         Print(7,' 저는 지금 아프로디테 테라에서 오는 길입니');
         Print(7,'다. 거기서 우연히 트롤족의 계보를 보았는데');
         Print(7,'그 종족은 왕권 세습제이며 왕권 중심으로 사');
         Print(7,'회가 구성되어 있습니다. 트롤족의 왕은 그리');
         Print(7,'강하지 않지만 그의 부하들 중에는 꽤 강한자');
         Print(7,'가 있습니다.');
         setbit(51);
      end;
      if on(90,80) then begin
         Clear;
         if getbit(8) and (not getbit(7)) then begin
            Print(7,' 거기에는  오크의 글로 적혀진  비석이 있었');
            Print(7,'다.  그리고 당신은  그 글을 읽어 내려갔다.');
            Print(7,'거기에 적힌 주문을 외자 갑자기 당신의 머리');
            Print(7,'가 혼란스러워졌고 곧 정신을 잃었다.');
            setbit(7);
            delay(2000);
            Delete_Scroll_Screen;
            with party do begin
               day := day + 1;
               hour := 23;
               min := 0;
               sec := 0;
            end;
            x := 82; y := 52;
            Silent_Scroll;
         end else if getbit(7) then begin
            Print(7,' 거기에는 오크의 글로 쓰여진 비석이 여전히');
            Print(7,'있었다.');
         end else begin
            Print(7,' 거기에는 비석이 하나  서 있었지만  도저히');
            Print(7,'무슨 글인지 알아 볼 수가 없었다.');
         end;
      end;
      if on(44,7) then begin
         Clear;
         if getbit(3) then begin
            if (not getbit(203)) and (party.etc[20] < 4) then begin
               Print(7,' 당신이 아프로디테 게이트 안으로 막들어 가');
               Print(7,'려고할 때, 허공에서 낯익은 목소리가 당신을');
               Print(7,'불렀다. 그 목소리의 주인공은 바로 로드안이');
               Print(7,'었다');
               PressAnyKey;
               Print(10,' 드디어 이곳까지 왔군요. 내가 한 가지 부탁');
               Print(10,'을 더 해도 되겠소?  이미 베스퍼성은 쑥밭이');
               Print(10,'되어서  사실상 원정은  더 이상 필요치 않게');
               Print(10,'되었소. 그래서 부탁하건데 우리의 원흉인 트');
               Print(10,'롤족을  완전히 멸해 주시오.  그들의 마을은');
               Print(10,'베스퍼성 북동쪽 산악지역에 있소. 당신의 승');
               Print(10,'리를 기원하리라.');
               Print(11,'[ 경험치 + 10000 ]');
               for i := 1 to 6 do
               if exist(i) then player[i].experience := player[i].experience + 10000;
               setbit(203);
               PressAnyKey;
            end;
            Print(7,' 당신이 이 곳에 서자  새로운 풍경이 나타나');
            Print(7,'기 시작했다.');
            mapname := 'Ground3';
            x := 13; y := 12;
            Load;
            OverLap(300,TRUE);
         end;
      end;
   end;

   if mapname = 'Gaea' then begin
      if on(18,27) then Find_Gold(142,5000);
      if on(16,23) then Find_Gold(143,10000);
      if on(15,25) then Find_Gold(144,(random(9)+1) * 1000);
      if on(12,26) then Find_Gold(145,(random(9)+1) * 1000);
      if on(10,24) and (not getbit(146)) then begin
         if party.etc[21] < 3 then Find_Gold(146,(random(9)+1) * 1000)
         else begin
            Clear;
            cPrint(7,11,'당신은 ','화염의 크리스탈','을 발견했다.');
            inc(party.crystal[1]);
         end;
         setbit(146);
      end;
      if on(23,25) and (party.etc[21] = 3) then begin
         x := 20;
         Scroll(TRUE);
      end;
      if on(21,25) and (party.etc[21] = 3) then begin
         x := 24;
         Scroll(TRUE);
      end;
      if (y = 10) and (not (getbit(3) and getbit(4))) then begin
         inc(y);
         Clear;
         Print(13,'원인을 알 수 없는 힘이 당신을 거부했다.');
         Silent_Scroll;
      end;
      if y = 6 then begin
         if not (getbit(3) and getbit(4)) then begin
            inc(y);
            Clear;
            Print(7,'게이트는 전혀 작동하지 않았다.');
            Silent_Scroll;
         end else begin
            Screen_Fade_Out(300);
            absolute_set_xy := TRUE;
            mapname := 'Ground4';
            x := 48; y := 36;
            Load;
            absolute_set_xy := FALSE;
            Silent_Scroll;
         end;
      end;
      if y = 45 then begin
         if wantexit then DefaultExit
         else begin
            dec(y);
            Silent_Scroll;
         end;
      end;
   end;

   if mapname = 'OrcTown' then begin
      if (y = 19) and (not getbit(55)) then begin
         Clear;
         enemynumber := 8;
         for i := 1 to 3 do joinenemy(i,19);
         for i := 4 to 7 do joinenemy(i,20);
         joinenemy(8,22);
         DisplayEnemies(TRUE);
         Print(7,' 당신 앞에는  어느새인가 매직유저들이 길을');
         Print(7,'막고 서 있었다.');
         if getbit(7) then begin
            Print(7,' 그 중에서 마법사 차림을 제대로 한 오크 하');
            Print(7,'나가 당신에게 말을했다.');
            Print(7,'');
            Print(13,' 나는 오크킹님을 위해 죽고 사는 아키메이지');
            Print(13,'라고 한다. 나를 쓰러뜨리기 전에는 오크킹님');
            Print(13,'을 만날 수가 없다.');
         end;
         PressAnyKey;
         BattleMode(FALSE,TRUE);
         if party.etc[6] = 254 then exit;
         if party.etc[6] = 2 then begin
            Silent_Scroll;
            exit;
         end;
         PutMap(23,18,43);
         setbit(55);
         Silent_Scroll;
      end;
      if (x in [24..27]) and (y in [16..18]) and (not getbit(56)) then begin
         Clear;
         enemynumber := 6;
         for i := 1 to 2 do joinenemy(i,21);
         joinenemy(3,23);
         for i := 4 to 5 do joinenemy(i,20);
         joinenemy(6,24);
         DisplayEnemies(TRUE);
         Print(7,' 당신이 오크킹에게 접근하자  모든 전투사들');
         Print(7,'이 오크킹 주위를 막아섰다.');
         if getbit(7) then begin
            Print(7,' 그러자 오크킹이 당신에게 말했다.');
            Print(7,'');
            Print(13,' 당신이  왜 나를  죽이려 하는지 모르겠지만');
            Print(13,'결과는 뻔한 일이다.');
            Print(13,' 자! 한바탕 붙어보자!!');
         end;
         PressAnyKey;
         BattleMode(FALSE,TRUE);
         if party.etc[6] = 254 then exit;
         if party.etc[6] = 2 then begin
            Silent_Scroll;
            x := 25; y := 21;
            exit;
         end;
         PutMap(25,17,43); PutMap(26,17,43);
         setbit(56);
         setbit(3);
         for i := 53 to 64 do setbit(i);
         party.etc[21] := 2;
         for i := 1 to 6 do begin
            if (player[i].name <> '') and (player[i].dead = 0) then
            player[i].experience := player[i].experience + 15000;
         end;
         Silent_Scroll;
         Clear;
         Print(14,' 당신은 오크족의 보스인 오크킹을 물리쳤다.');
         Print(11,'[ 경험치 + 15000 ]');
      end;
      if y = 45 then begin
         if wantexit then DefaultExit
         else begin
            dec(y);
            Silent_Scroll;
         end;
      end;
   end;

   if mapname = 'Ground3' then begin
      if on(13,11) then begin
         Clear;
         Print(7,' 당신이 이 곳에 서자  새로운 풍경이 나타나');
         Print(7,'기 시작했다.');
         mapname := 'Ground2';
         x := 44; y := 8;
         Load;
         OverLap(300,TRUE);
      end;
   end;

   if mapname = 'Vesper' then begin
      if (x in [5,71]) or (y in [6,70]) then begin
         if wantexit then begin
            absolute_set_xy := TRUE;
            mapname := 'Ground3';
            x := Map_Header.ExitX;
            y := Map_Header.ExitY;
            x := x + x1;
            y := y + y1;
            Load;
            Scroll(TRUE);
            absolute_set_xy := FALSE;
         end else begin
            x := x - x1;
            y := y - y1;
            Silent_Scroll;
         end;
      end;
   end;

   if mapname = 'TrolTown' then begin
      if on(6,36) or on(45,29) then begin
         Clear;
         Print(7,' 당신이 아래에 있는 벽돌을 밟자  벽돌은 약');
         Print(7,'간 아래로 꺼졌다.  그리고 몇 초후에 둔탁한');
         Print(7,'기계음이 들렸다.');
         for i := 25 to 26 do
         if on(6,36) then begin
            for j := 24 to 25 do PutMap(i,j,44);
         end else begin
            for j := 22 to 23 do PutMap(i,j,44);
         end;
      end;
      if (x in [25..26]) and (y in [26..30]) then begin
         if party.etc[4] = 0 then begin
            Clear;
            Print(7,'일행은 계곡으로 떨어져 버렸다.');
            PressAnyKey;
            party.etc[6] := 255;
            GameOver;
            exit;
         end;
      end;
      if on(13,19) then begin
         Clear;
         Print(7,' 당신이 이곳에 서자 갑자기 부비트랩이 작동');
         Print(7,'하며 거대한 폭발이 일어났고, 곧이어 의식이');
         Print(7,'흐려졌다');
         PressAnyKey;
         party.etc[6] := 255;
         GameOver;
         exit;
      end;
      if on(12,17) and (not getbit(130)) then begin
         Clear;
         cPrint(7,11,'당신은 ','에너지 크리스탈','을 발견했다.');
         inc(party.crystal[7]);
         setbit(130);
      end;
      if on(14,17) and (not getbit(131)) then begin
         Clear;
         cPrint(7,11,'당신은 ','한파의 크리스탈','을 발견했다.');
         inc(party.crystal[2]);
         setbit(131);
      end;
      if on(12,21) and (not getbit(132)) then begin
         Clear;
         Find_Gold(132,15000);
         setbit(132);
      end;
      if on(14,21) and (not getbit(133)) then begin
         Clear;
         Print(7,'당신은 식량 200개를 발견했다.');
         if party.food + 200 < 256 then inc(party.food,200)
         else party.food := 255;
         setbit(133);
      end;
      if (y = 70) then begin
         if wantexit then DefaultExit
         else begin
            dec(y);
            Silent_Scroll;
         end;
      end;
   end;

   if mapname = 'Ground4' then begin
      if on(48,35) then begin
         Screen_Fade_Out(300);
         DefaultExit;
      end;
   end;

   if mapname = 'Ancient' then begin
      if on(10,13) or on(11,13) then begin
         Clear;
         Print(7,' 당신은  무덤 앞으로 발을  내 디디려 했지만');
         Print(7,'어떤 힘에 의해 더 이상 들어 갈 수가 없었다.');
         inc(y);
         Silent_Scroll;
      end;
      if on(10,12) or on(11,12) then begin
         Clear;
         Print(7,'');
         Print(7,'');
         Print(15,'         Rest In Peace ----------');
         Print(7,'');
         Print(10,'              에인션트 이블');
         Print(7,'');
         Print(15,'        348 년 가을, 여기에 잠들다');
         if not getbit(206) then begin
            PressAnyKey;
            Print(11,' [ 경험치 + 500000 ]');
            for i := 1 to 6 do begin
               if exist(i) then
               player[i].experience := player[i].experience + 500000;
            end;
            setbit(206);
         end;
      end;
      if (x in [5,16]) or (y in [6,25]) then begin
         if wantexit then begin
            absolute_set_xy := TRUE;
            mapname := 'Ground4';
            x := Map_Header.ExitX;
            y := Map_Header.ExitY;
            x := x + x1;
            y := y + y1;
            Load;
            Scroll(TRUE);
            absolute_set_xy := FALSE;
         end else begin
            x := x - x1;
            y := y - y1;
            Silent_Scroll;
         end;
      end;
   end;

   if mapname = 'Hut' then begin
      if on(9,13) and (not getbit(204)) then begin
         Clear;
         Print(7,' 당신은 앞에 있는 창을 가졌다');
         Print(11,' [ 랜서 + 1 ]');
         if party.BackPack[3,6] + 1 < 255 then inc(party.BackPack[3,6]);
         setbit(204);
         PutMap(8,13,35);
         Silent_Scroll;
      end;
      if on(9,14) and (not getbit(205)) then begin
         Clear;
         Print(7,' 당신은 앞에 있는 갑옷을 가졌다');
         Print(11,' [ 라멜라 + 1 ]');
         if party.BackPack[6,7] + 1 < 255 then inc(party.BackPack[6,7]);
         setbit(205);
         PutMap(8,14,35);
         Silent_Scroll;
      end;
      if (x in [5,26]) or (y in [6,25]) then begin
         if wantexit then begin
            absolute_set_xy := TRUE;
            mapname := 'Ground4';
            x := Map_Header.ExitX;
            y := Map_Header.ExitY;
            x := x + x1;
            y := y + y1;
            Load;
            Scroll(TRUE);
            absolute_set_xy := FALSE;
         end else begin
            x := x - x1;
            y := y - y1;
            Silent_Scroll;
         end;
      end;
   end;

   if mapname = 'Ground5' then begin
      Clear;
      Print(7,' 당신은 잠을 자고있는 어떤 은둔자를 보았다.');
      Print(7,'그는 당신의 기척에 잠을 깨었는지  눈을 뜨고');
      Print(7,'당신을 바라 보았다. 그리고는 말을 시작했다.');
      Print(7,'');
      if getbit(14) then begin
         if getbit(13) then begin
            Print(9,' 이제 당신은 드라코니안의 말을 들을 수 있을');
            Print(9,'것입니다.');
         end else begin
            Print(9,' 나에게는 당신이  뭘 원하는지 훤히 보이는군');
            Print(9,'요. 당신은 지금 드라코니안의 말을 배우려 하');
            Print(9,'고있죠?');
            if party.etc[5] > 0 then begin
               Print(9,' 그럼 가르쳐 드리죠.  이건 제가 발명한 자동');
               Print(9,'통역기인데 귀속에다 넣을면  드라코니안의 말');
               Print(9,'을 들을 수 있을 것입니다.');
               setbit(13);
            end else begin
               Print(9,' 하지만 귀찮아서 가르쳐 주고 싶지 않군요.');
            end;
         end;
      end else begin
         Print(9,' 혹시 당신 지금 드라코니안의 글을 배우려 하');
         Print(9,'지 않습니까? 그렇다면 이 대륙 전체를 뒤져서');
         Print(9,'금빛의 인어를 찾아 보십시오.');
      end;
   end;

   if mapname = 'DracTown' then begin
      if x = 5 then begin
         if wantexit then begin
            DefaultExit;
            if getbit(6) then PutMap(15,31,53);
         end else begin
            inc(x);
            Silent_Scroll;
         end;
      end;
      if on(65,101) and (not getbit(29)) then begin
         Clear;
         Print(7,' 갑자기 호수 밑에서 누군가가 당신의 발을 잡');
         Print(7,'고 호수 밑으로 끌어 내리려 했다.  하지만 당');
         Print(7,'신의 물 위를 걷는 마법때문에 당신은 전혀 끌');
         Print(7,'려 들어가지 않았다. 도리어 당신이 정체 불명');
         Print(7,'의 손을 끌어 올려 물 밖으로 들어 올렸다. 놀');
         Print(7,'랍게도 당신이 물 밖으로 끌어 올린 것은 금빛');
         Print(7,'의 인어였다. 그녀는 겁에 질려 당신에게 애원');
         Print(7,'했다.');
         PressAnyKey;
         Print(9,' 제발 살려주세요. 그냥 장난친것 뿐이예요.');
         Print(9,' 만약 살려 주시면  당신에게  드라코니안족의');
         Print(9,'글을 가르쳐 드릴께요.');
         setbit(29);
         m[0] := '';
         m[1] := '인어를 놓아준다';
         m[2] := '죽여 버린다';
         if Select(160,2,2,FALSE,TRUE) <> 2 then begin
            Print(9,' 그 인어는 당신에게 금빛의 가루를 뿌렸다.');
            Print(9,' 그러자 당신은 약간의 어지러움을 느꼈다.');
            setbit(14);
         end else begin
            Print(7,' 당신은 그 인어를 죽여 버렸다.');
         end;
      end;
   end;
   if on(76,73) and (not getbit(104)) then begin
      setbit(104);
      Clear;
      Print(11,' [ 화살 + 400 ]');
      if party.arrow + 400 < 60000 then inc(party.arrow,400);
      PutMap(77,73,44);
      Silent_Scroll;
   end;
   if on(68,66) and (not getbit(105)) then begin
      Clear;
      Print(7,' 당신이 보물상자를 열자  갑자기 흡혈귀가 튀');
      Print(7,'어나왔다.');
      PressAnyKey;
      enemynumber := 8;
      for i := 1 to 8 do joinenemy(i,4);
      DisplayEnemies(TRUE);
      BattleMode(FALSE,TRUE);
      if party.etc[6] = 254 then exit;
      if party.etc[6] = 2 then begin
         Silent_Scroll;
         exit;
      end;
      setbit(105);
      PutMap(67,66,44);
      Silent_Scroll;
   end;
   if on(68,73) and (not getbit(106)) then begin
      setbit(106);
      Clear;
      Print(11,' [ 식량 + 255 ]');
      party.food := 255;
      PutMap(67,73,44);
      Silent_Scroll;
   end;
   if on(63,71) and (not getbit(107)) then begin
      setbit(107);
      Clear;
      Print(11,' [ 황금 + 200000 ]');
      party.gold := party.gold + 200000;
      PutMap(62,71,44);
      Silent_Scroll;
   end;
   if on(68,88) and (not getbit(108)) then begin
      setbit(108);
      Clear;
      Print(11,' [ 소환의 크리스탈 + 1 ]');
      inc(party.crystal[6]);
      PutMap(67,88,44);
      Silent_Scroll;
   end;
   if on(63,79) and (not getbit(109)) then begin
      Clear;
      Print(7,' 당신이  보물상자를 열자  갑자기 드라큐라가');
      Print(7,'튀어나왔다.');
      PressAnyKey;
      enemynumber := 5;
      for i := 1 to 5 do joinenemy(i,14);
      DisplayEnemies(TRUE);
      BattleMode(FALSE,TRUE);
      if party.etc[6] = 254 then exit;
      if party.etc[6] = 2 then begin
         Silent_Scroll;
         exit;
      end;
      setbit(109);
      PutMap(62,79,44);
      Silent_Scroll;
   end;
   if on(64,64) and (not getbit(110)) then begin
      setbit(110);
      Clear;
      Print(11,' [ 한파의 크리스탈 + 1 ]');
      inc(party.crystal[2]);
      PutMap(65,64,44);
      Silent_Scroll;
   end;
   if on(97,100) then begin
      Clear;
      cPrint(7,15,' 묘비에는 ','제 21대 드라콘 제왕의 묘','라고 쓰여');
      Print(7,'있었다.');
   end;
   if on(89,103) then begin
      Clear;
      cPrint(7,15,' 묘비에는 ','제 17대 드라콘 제왕의 지하 묘','라고');
      Print(7,'쓰여 있었고  바로 밑에는 기묘하게 생긴 바닥');
      Print(7,'이 있었다.');
      if getbit(30) then exit;
      PressAnyKey;
      Print(7,' 당신이 바닥을 밀어내자  바닥이 스르르 밀려');
      Print(7,'나며 좁은 지하계단이 나타났다.  계단의 입구');
      Print(7,'에는 스산한 기운이 맴돌고 있었고  자세히 다');
      Print(7,'시 보니 뚜렸하게 이런 글자가 새겨져 있었다.');
      Print(12,'''이곳으로 발을 디딘 자는 드라콘 제왕의 저주');
      Print(12,'를 받게 될 것이다.''');
      m[0] := '';
      m[1] := '지하계단으로 내려간다';
      m[2] := '다시 바닥을 원위치 시킨다';
      if Select(200,2,2,FALSE,TRUE) <> 1 then begin
         Print(7,' 당신이 바닥을 끌어 당기자 다시 스르르 밀려');
         Print(7,'와서 원위치 되었다.');
         exit;
      end;
      k := 0;
      for i := 5 downto 2 do begin
         if exist(i) then k := i;
      end;
      if k > 0 then begin
         s := ReturnBJosa(player[k].name);
         if s = '가' then s := '';
         s := player[k].name + s;
         Print(7,' 당신이 일행들을 데리고 지하계단으로 내려가');
         Print(7,'려 하자 당신을 저지시키는 사람이 있었다.');
         Print(7,' 그는 바로 '+s+'였다.');
         Print(7,' 그는 말을 했다.');
         PressAnyKey;
         Print(9,' 우리들의 목적은 따로 있는데 일부러 이런 모');
         Print(9,'험을 할 필요가 없지 않은가?  우리들은  모두');
         Print(9,'여기에 있겠네.  게다가 계단에 쓰여 있는  이');
         Print(9,'글도 마음에 걸린다네. 정말 가고 싶다면 자네');
         Print(9,'혼자서 가게나. 우리는 여기서 기다릴테니.');
         m[0] := '';
         m[1] := '혼자라도 지하무덤으로 간다';
         m[2] := '대원들의 의견대로 그만 둔다';
         if Select(200,2,2,FALSE,TRUE) = 2 then begin
            Print(7,' 당신은 다시 물러서서 바닥을 원위치 시켰다.');
            exit;
         end;
      end;
      setbit(30);
      for i := 2 to 5 do begin
         for j := 0 to 8 do player[i].name[j+9] := player[i].name[j];
         player[i].name[0] := chr(0);
      end;
      Display_Condition;
      DefaultEnter;
   end;

   if mapname = 'Tomb' then begin
      if on(83,10) then PutMap(39,31,44);
      if on(19,35) and (not getbit(124)) then begin
         setbit(124);
         Clear;
         Print(11,' [ 플래티움 갑옷 + 1 ]');
         if party.BackPack[6,10] < 255 then inc(party.BackPack[6,10]);
      end;
      if on(84,15) and (not getbit(125)) then begin
         setbit(125);
         Clear;
         Print(11,' [ 황금 + 100000 ]');
         party.gold := party.gold + 100000;
      end;
      if on(87,15) and (not getbit(126)) then begin
         setbit(126);
         Clear;
         Print(11,' [ 황금 + 50000 ]');
         party.gold := party.gold + 50000;
      end;
      if on(84,26) and (not getbit(127)) then begin
         Clear;
         Print(7,' 당신이  보물상자를 열자  갑자기 저승사자가');
         Print(7,'튀어나왔다.');
         PressAnyKey;
         enemynumber := 1;
         joinenemy(1,1);
         enemy[1].level := 30;
         enemy[1].hp := enemy[1].endurance * enemy[1].level * 10;
         DisplayEnemies(TRUE);
         BattleMode(FALSE,TRUE);
         if party.etc[6] = 254 then exit;
         if party.etc[6] = 2 then begin
            Silent_Scroll;
            exit;
         end;
         setbit(127);
      end;
      if on(87,26) and (not getbit(128)) then begin
         Clear;
         Print(7,' 당신이  보물상자를 열자  갑자기 켈베로스가');
         Print(7,'튀어나왔다.');
         PressAnyKey;
         enemynumber := 5;
         for i := 1 to 5 do begin
            joinenemy(i,12);
            enemy[i].level := 15;
            enemy[i].hp := enemy[i].endurance * enemy[i].level * 10;
         end;
         DisplayEnemies(TRUE);
         BattleMode(FALSE,TRUE);
         if party.etc[6] = 254 then exit;
         if party.etc[6] = 2 then begin
            Silent_Scroll;
            exit;
         end;
         setbit(128);
      end;
      if on(85,21) and (not getbit(129)) then begin
         Clear;
         Print(7,' 당신이 괸 앞에 섰을때 무언가 묘한 분위기가');
         Print(7,'당신의 전신을 스치고 지나갔다.  잠시후 관의');
         Print(7,'뚜껑이 스르르 열리기 시작했다.  당신은 무의');
         Print(7,'식적으로 한 걸음 뒤로 물러났다. 곧이어 관속');
         Print(7,'에서는  에테르화된 드라코니안의 형체가 일어');
         Print(7,'났다. 그리고 말을 하기 시작했다.');
         PressAnyKey;
         enemynumber := 1;
         joinenemy(1,58);
         enemy[1].name := '17대 드라콘제왕';
         enemy[1].specialcastlevel := enemy[1].specialcastlevel or $80;
         DisplayEnemies(TRUE);
         Print(13,' 100년만에 도굴꾼이 또 이곳에 나타났군.  너');
         Print(13,'도 역시 내가 가지고 있는  영혼의 크리스탈을');
         Print(13,'훔칠 목적으로 여기에 온 것임에 틀림없다. 하');
         Print(13,'지만 너도 별 수없이  이 앞의 해골과 같은 운');
         Print(13,'명이 될것이다.');
         PressAnyKey;
         repeat
            BattleMode(FALSE,TRUE);
            if party.etc[6] = 254 then exit;
            if party.etc[6] = 2 then Clear;
         until party.etc[6] = 0;
         Clear;
         Print(11,' [ 영혼의 크리스탈 + 1 ]');
         setbit(129);
         inc(party.crystal[5]);
      end;
   end;

   if mapname = 'Imperium' then begin
      if y = 45 then begin
         if wantexit then begin
            DefaultExit;
            PutMap(x,y-1,53);
         end
         else begin
            dec(y);
            Silent_Scroll;
         end;
      end;
      if on(28,17) then begin
         Clear;
         SetColor(Yellow);
         i := hwinx1; j := hwiny1;
         cHPrint(i,j,' You  ask  Young-Kie  how to play this game'); inc(j,16);
         cHPrint(i,j,'easilly. Young-Kie''s smile makes you uneasy'); inc(j,16);
         cHPrint(i,j,', as uneasy as  staring down the sources of'); inc(j,16);
         cHPrint(i,j,'game programs. " It''s really very simple, "'); inc(j,16);
         cHPrint(i,j,'he  laughs. " This game''s  secret  code  is'); inc(j,16);
         cHPrint(i,j,'ascii #197. "');
      end;
      if on(25,24) then begin
         if not getbit(31) then begin
            Clear;
            Print(7,' 드디어 '+player[1].name+'님이 여기에 당도 하셨군요.');
            Print(7,' 저의 소개를 하자면 바로 그 에인션트 이블입');
            Print(7,'니다. 저의 육체는 벌써 오래전에 사라지고 없');
            Print(7,'습니다. 저는 로드안과는 달리 그저 평범한 인');
            Print(7,'간이었으니까요.  지금은  나의 의지만이 남아');
            Print(7,'반신반인의 경지에서  이렇게 이곳에 존재하고');
            Print(7,'있습니다. 그럼 본론으로 들어가겠습니다.');
            Print(7,' 저는 예전에 로드안에게, 선을 위해서라면 나');
            Print(7,'의 이름을 이용하여  악을 비난해도 좋다고 약');
            Print(7,'속했었습니다.  그래서 로어 세계에서  어떠한');
            Print(7,'안좋은 일이 생기더라도  저의 소행이었노라고');
            Print(7,'치부해버리며  로드안은 자신의 지위를 유지할');
            Print(7,'수 있었습니다.  하지만 로드안은 해가 갈수록');
            Print(7,'자신의 위치를 지키기 위해서  저의 이름을 이');
            Print(7,'용한다는 느낌이 와닿기 시작했습니다. 원래의');
            Print(7,'그는 전혀 그럴 사람이 아니었는데  너무나 큰');
            Print(7,'명성과 지위에 올라있다보니  로어성의 성주라');
            Print(7,'는 직책이 그를 자신만을 생각하는 현실주의자');
            Print(7,'로 바꾸어 버린 것입니다.  선의 대표자로서의');
            Print(7,'그는 항상 주위를 환기 시킬만한  선행을 찾기');
            Print(7,'시작했고  결국은 남에게 보이기 위한 선을 행');
            Print(7,'하기 시작했습니다.  그리고  급기야 이번같은');
            Print(7,'큰 실수를  저지르고야 말았습니다.  로드안은');
            Print(7,'인간을 너무 생각하는 마음에서 인간의 영역을');
            Print(7,'늘려주기 원했고  그 결과는 타종족에 대한 침');
            Print(7,'범으로 이어졌습니다.  이건 분명 로드안의 잘');
            Print(7,'못된 행동이며 거의 돌이킬 수 없는 결과를 낳');
            Print(7,'고야 말았습니다.  지금의 그는 권력과 명예의');
            Print(7,'노예가 되어  광적으로 이 일을 강행하고 있습');
            Print(7,'니다. 그리고 이 일이 다 끝나더라도 더 큰 명');
            Print(7,'예를 얻기위해 선행을 빙자한 다른 일을 또 꾸');
            Print(7,'밀 것입니다.');
            Print(7,' 만약 저의 말이 맞다는게 확인되면 부디 저의');
            Print(7,'편에 서서 저를 도와주십시요. 저는 당신과 같');
            Print(7,'은 분의 도움이 크게 필요합니다.');
            Print(7,'');
            PressAnyKey;
            setbit(31);
         end;
         Clear;
         Print(7,' 지금 당신을 로어성 앞으로 공간이동 시켜 드');
         Print(7,'리겠습니다.  거기서 저와 로드안의 진위를 확');
         Print(7,'인해 주시기 바랍니다.');
         m[0] := '';
         m[1] := '공간이동을 한다';
         m[2] := '공간이동을 하지않는다';
         if Select(180,2,2,FALSE,TRUE) = 1 then begin
            party.etc[20] := 7;
            DefaultEnter;
         end;
      end;
   end;
end;

Procedure SpecialEvent_Sub2;
label
   battle1, battle2, battle3, battle4;
var
   x0,y0,x2,y2 : integer;
begin

   Scroll(TRUE);

   if mapname = 'Kobold' then begin
      if x = 5 then begin
         if wantexit then begin
            if getbit(86) then begin
               Clear;
               Print(7,' 당신이 문을 나서려 하자  도망쳤던 코볼트킹');
               Print(7,'이 당신 앞을 가로 막았다.');
               Print(7,'');
               Print(13,' 나는 너를 내 손으로 처치하지 않고는 편안히');
               Print(13,'죽을 수가 없었다. 그래서 나는 영원한 생명을');
               Print(13,'가지기를 원했고  그 댓가로 악마에게 혼을 팔');
               Print(13,'았다. 나는 결코 죽지않고 너를 끝까지 괴롭힐');
               Print(13,'것이다.');
               PressAnyKey;
               repeat
                  Clear;
                  enemynumber := 1;
                  joinenemy(1,45);
                  DisplayEnemies(TRUE);
                  BattleMode(FALSE,TRUE);
                  if party.etc[6] = 254 then exit;
               until party.etc[6] = 2;
            end;
            DefaultExit;
            if getbit(86) then begin
               Clear;
               Print(7,' 당신이 성 밖으로 탈출하자  허공에서 로드안');
               Print(7,'의 음성이 들려왔다.');
               Print(7,'');
               Print(10,' 당신은 빨리 이곳을 나가시오.  나의 선의 봉');
               Print(10,'인으로  악마의 힘을 빌린 코볼트킹을 막겠소.');
               Print(10,'아마 그는 다시는 이 성을 벗어나지 못할거요.');
               Print(7,'');
               Print(7,' 말이채 끝나기도 전에 코볼트성 주위에는  구');
               Print(7,'형의 결계가 형성 되었고  곧이어 기의 파문이');
               Print(7,'일렁이기 시작했다.');
               setbit(5);
            end;
         end
         else begin
            inc(x);
            Silent_Scroll;
         end;
      end;
      if on(8,30) and (Real_Map(9,30) <> 53) then begin
         PutMap(9,30,53);
         Silent_Scroll;
         Clear;
         Print(7,' 갑자기 땅에서 푯말이 솟아 나왔다.');
      end;
      if (x in [30..55]) and (y in [21..36]) then begin
         if on(49,31) and (not getbit(17)) then begin
            Clear;
            enemynumber := 7;
            for i := 1 to 5 do joinenemy(i,36);
            for i := 6 to 7 do joinenemy(i,39);
            DisplayEnemies(TRUE);
            BattleMode(FALSE,TRUE);
            if party.etc[6] = 254 then exit;
            if party.etc[6] = 2 then begin
               Silent_Scroll;
               exit;
            end;
            Clear;
            Print(7,' 당신은 쓰러진  코볼트 근위기사의 몸을 뒤져');
            Print(7,'에메랄드키를 찾아냈다.');
            setbit(17);
         end else begin
            for j := y - 1 to y + 1 do
            for i := x - 1 to x + 1 do PutMap(i,j,50);
            Silent_Scroll;
         end;
      end;
      if on(38,13) then begin
         PutMap( 99,21,43);
         Clear;
         Print(7,' 당신이 바닥의 기묘한 벽돌을 밟자 돌이 약간');
         Print(7,'밑으로 들어갔다.');
      end;
      if on(121,36) then begin
         PutMap(110,26,43);
         Clear;
         Print(7,' 당신이 바닥의 기묘한 벽돌을 밟자 돌이 약간');
         Print(7,'밑으로 들어갔다.');
      end;
      if on(112,29) then begin
         PutMap( 96,21,43);
         Clear;
         Print(7,' 당신이 바닥의 기묘한 벽돌을 밟자 돌이 약간');
         Print(7,'밑으로 들어갔다.');
      end;
      if on(96,36) then begin
         PutMap(107,30,43);
         Clear;
         Print(7,' 당신이 바닥의 기묘한 벽돌을 밟자 돌이 약간');
         Print(7,'밑으로 들어갔다.');
      end;
      if on(105,27) then begin
         PutMap(118,35,43);
         Clear;
         Print(7,' 당신이 바닥의 기묘한 벽돌을 밟자 돌이 약간');
         Print(7,'밑으로 들어갔다.');
      end;
      if on(100,36) and (not getbit(18)) then begin
         Clear;
         enemynumber := 8;
         for i := 1 to 7 do joinenemy(i,36);
         joinenemy(8,39);
         DisplayEnemies(TRUE);
         BattleMode(FALSE,TRUE);
         if party.etc[6] = 254 then exit;
         if party.etc[6] = 2 then begin
            Silent_Scroll;
            exit;
         end;
         Clear;
         Print(7,' 당신은 벽에 걸려 있는 황금 키를 가졌다.');
         setbit(18);
      end;
      if on(32,90) and (not getbit(19)) then begin
         Clear;
         enemynumber := 8;
         for i := 1 to 7 do joinenemy(i,36);
         joinenemy(8,37);
         DisplayEnemies(TRUE);
         BattleMode(FALSE,TRUE);
         if party.etc[6] = 254 then exit;
         if party.etc[6] = 2 then begin
            Silent_Scroll;
            exit;
         end;
         Clear;
         Print(7,' 당신은 코볼트 매직유저의 몸을 뒤져서  백금');
         Print(7,'키를 발견했다.');
         setbit(19);
      end;
      if (x in [96..119]) and (y in [85..98]) then begin
         if random(2) = 0 then begin
            x2 := x1; y2 := y1;
         end else repeat
            x2 := random(3) - 1; y2 :=  random(3) - 1;
         until not((x2 = 0) and (y2 = 0));
         x0 := x + x2; y0 := y + y2;
         case Real_Map(x0,y0) of
            43 : begin
                    PutMap(x,y,43); PutMap(x0,y0,0);
                 end
            else begin
                    x0 := x - 2 * x2;
                    y0 := y - 2 * y2;
                    PutMap(x,y,43);
                    PutMap(x0,y0,0);
                 end;
         end;
         if Real_Map(x+x1,y+y1) in [37,38] then begin
            x := x + x1 * 2;
            y := y + y1 * 2;
            Silent_Scroll;
         end;
      end;
      if on(95,91) and (not getbit(20)) then begin
         Clear;
         enemynumber := 8;
         for i := 1 to 6 do joinenemy(i,36);
         for i := 7 to 8 do joinenemy(i,37);
         DisplayEnemies(TRUE);
         BattleMode(FALSE,TRUE);
         if party.etc[6] = 254 then exit;
         if party.etc[6] = 2 then begin
            Silent_Scroll;
            exit;
         end;
         Clear;
         Print(7,' 당신은 벽에 걸린 사파이어 키를 가졌다.');
         setbit(20);
      end;

      if (x = 27) and getbit(18) then begin
         PutMap(28,60,43); PutMap(28,61,43);
         PutMap(29,60,0); PutMap(29,61,0);
         Silent_Scroll;
      end;
      if (x = 124) and getbit(19) and getbit(89) then begin
         PutMap(123,60,43); PutMap(123,61,43);
         PutMap(122,60,0); PutMap(122,61,0);
         Silent_Scroll;
      end;
      if (x = 62) and getbit(20) then begin
         for j := 60 to 61 do
         for i := 63 to 64 do PutMap(i,j,43);
         PutMap(65,60,0); PutMap(65,61,0);
         Silent_Scroll;
      end;
      if (x = 27) and getbit(17) then begin
         for j := 60 to 61 do
         for i := 87 to 88 do PutMap(i,j,43);
         PutMap(86,60,0); PutMap(86,61,0);
         Silent_Scroll;
      end;

      if (x = 122) and (not getbit(92)) then begin
         Clear;
         enemynumber := 8;
         for i := 1 to 6 do joinenemy(i,39);
         for i := 7 to 8 do joinenemy(i,40);
         DisplayEnemies(TRUE);
         Print(13,' 정말 끈질긴 인간들이군. 번번히 패하면서 또');
         Print(13,'시비를 걸어 오다니...');
         PressAnyKey;
         BattleMode(FALSE,TRUE);
         if party.etc[6] = 254 then exit;
         if party.etc[6] = 2 then begin
            inc(x);
            Silent_Scroll;
            exit;
         end;
         setbit(92);
      end;
      if (x = 29) and (not getbit(91)) then begin
         Clear;
         enemynumber := 8;
         for i := 1 to 4 do joinenemy(i,39);
         for i := 5 to 7 do joinenemy(i,37);
         joinenemy(8,41);
         DisplayEnemies(TRUE);
         Print(13,' 또 인간들이 우리 성을 침범하러 왔군.  너희');
         Print(13,'들은 이 주위의 해골들이 보이지 않는가? 이것');
         Print(13,'들은 우리에게 무모한 싸움을 걸었다가 죽어간');
         Print(13,'사람들의 해골이다.');
         PressAnyKey;
         BattleMode(FALSE,TRUE);
         if party.etc[6] = 254 then exit;
         if party.etc[6] = 2 then begin
            dec(x);
            Silent_Scroll;
            exit;
         end;
         setbit(91);
      end;
      if (x = 86) and (not getbit(90)) then begin
         Clear;
         enemynumber := 8;
         for i := 1 to 7 do joinenemy(i,37);
         joinenemy(8,38);
         DisplayEnemies(TRUE);
         Print(13,' 나는 이 성의 경비대장이다.  나의 임무는 바');
         Print(13,'로 너희들을  이 안으로  들여 놓지 않는 것이');
         Print(13,'다. 나의 목숨을 바쳐서라도...');
         PressAnyKey;
         BattleMode(FALSE,TRUE);
         if party.etc[6] = 254 then exit;
         if party.etc[6] = 2 then begin
            inc(x);
            Silent_Scroll;
            exit;
         end;
         setbit(90);
      end;
      if (x = 86) and getbit(90) then begin
         for j := 60 to 61 do
         for i := 63 to 65 do PutMap(i,j,43);
         for j := 60 to 61 do
         for i := 28 to 29 do PutMap(i,j,43);
      end;
      if (x = 65) and (not getbit(89)) then begin
         Clear;
         enemynumber := 4;
         for i := 1 to 3 do joinenemy(i,39);
         joinenemy(4,42);
         DisplayEnemies(TRUE);
         Print(13,' 용케도 우리 성의 내부까지 들어왔군. 당신들');
         Print(13,'은 소환 마법이란걸 들어봤나? 지금 바로 내가');
         Print(13,'소환 마법의 진가를 보여주지.');
         PressAnyKey;
         BattleMode(FALSE,TRUE);
         if party.etc[6] = 254 then exit;
         if party.etc[6] = 2 then begin
            dec(x);
            Silent_Scroll;
            exit;
         end;
         setbit(89);
      end;

      if on(48,73) and (Real_Map(46,47) in [50]) then begin
         for j := 42 to 50 do
         for i := 37 to 54 do
         if Real_Map(i,j) in [50] then PutMap(i,j,49);
      end;
      if on(45,46) and (Real_Map(56,63) in [50]) then begin
         for j := 51 to 74 do
         for i := 56 to 60 do
         if Real_Map(i,j) in [50] then PutMap(i,j,48);
      end;
      if (x in [42..53]) and (y in [55..66]) then begin
         if party.etc[36] > 3 then exit;
         inc(party.etc[36]);
         PutMap(x,y,43);
         if party.etc[36] = 4 then begin
            Clear;
            Print(7,' 당신은 땅에 반쯤 묻혀있는  오팔키를 발견했');
            Print(7,'다.');
            setbit(21);
         end
         else PutMap(random(12)+42,random(12)+55,0);
      end;

      if (x in [91..121]) and (y in [41..80]) then begin
         if on(91,41) and (not getbit(22)) then begin
            Clear;
            Print(7,' 당신은 어둠속에서도  반짝이는 물체를  하나');
            Print(7,'보았다. 자세히보니 그것은 흑요석키였고 즉시');
            Print(7,'그것을 가졌다.');
            setbit(22);
            exit;
         end;
         if (on(91,59) or on(121,62)) and ebony then begin
            ebony := FALSE;
            Silent_Scroll;
            exit;
         end;
         if on( 93,60) then begin
            x := 91; y := 60;
            ebony := FALSE;
            Silent_Scroll;
            exit;
         end;
         if on(119,61) then begin
            x := 121; y := 61;
            Silent_Scroll;
            exit;
         end;
         if on(103,75) then begin
            x := 107; y := 60;
            ebony := FALSE;
            Silent_Scroll;
            exit;
         end;
         if on(108,75) then begin
            x := 102; y := 49;
            Silent_Scroll;
            exit;
         end;
         if on(105,58) and (Real_Map(105,59) <> 43) then begin
            PutMap(105,59,43);
            exit;
         end;
         if not ebony then begin
            ebony := TRUE;
            Silent_Scroll;
         end;
      end;

      if on(58,101) and (Real_Map(58,100) <> 49) then begin
         for j := 100 downto 86 do PutMap(58,j,49);
         PutMap(58,85,0);
         Silent_Scroll;
         Clear;
         Print(7,' 당신이 무심코 벽에 팔을 기대자 벽은 안으로');
         Print(7,'쑥 들어가 버렸다. 그리고는 새로운 길이 나타');
         Print(7,'났다.');
      end;
      if on(58,85) then begin
         PutMap(58,85,43);
         PutMap(76,74,52);
         Clear;
         Print(7,' 당신이 발 밑의 벽돌을 밟자  벽돌은  유압에');
         Print(7,'의해 서서히 가라앉기 시작했다.  당신은 즉시');
         Print(7,'벽돌에서 발을 떼고 한 걸음 물러섰다. 하지만');
         Print(7,'벽돌은 빨려 들어가듯이 밑으로 가라 앉았다.');
         k := 0;
         for i := 5 downto 2 do
            if exist(i) then k := i;
         if k > 0 then begin
            s := player[k].name + ReturnBJosa(player[k].name);
            Print(7,' 그때 옆에 있던 '+s+' 말했다.');
            Print(7,'');
            Print(9,' 이런 장치는 전에 한번 본 적이 있다네. 벽돌');
            Print(9,'이 가라 앉는 무게와 압력으로 다른 곳의 물체');
            Print(9,'를 떠올리는 장치라네. 그런데 어디가 다시 떠');
            Print(9,'올랐는지 모르겠군.');
         end;
      end;
      if on(76,74) then begin
         PutMap(65,25,35);
         PutMap(64,25,0);
         PutMap(76,74,48);
         Clear;
         Print(7,' 당신이 물 위로 떠오른 땅을 밟자  다시 가라');
         Print(7,'앉아 버렸다.');
         Silent_Scroll;
      end;
      if on(64,25) and (Real_Map(108,53) <> 0) then begin
         for j := 53 to 54 do
         for i := 108 to 109 do PutMap(i,j,0);
         PutMap(64,25,43);
         Print(7,' 성의 남동쪽에서  돌연히 커다란 진동음과 함');
         Print(7,'께 기계 소리가 들렸다.');
      end;
      if on(106,54) and (not getbit(200)) then begin
         Print(7,' 당신은 벽에서 무언가 반짝이는 것이 있어 벽');
         Print(7,'으로 다가갔다.  가까이에서 보니 그것은 수정');
         Print(7,'이었다.  하지만 그 수정은 특이하게도 스스로');
         Print(7,'희미한 빛을 발하고 있었다.  당신이 수정속을');
         Print(7,'들여다 보았을때  소스라치게 놀랄 수 밖에 없');
         Print(7,'었다.  그속에는 형체를 분간하기 힘들 정도의');
         Print(7,'많은 영혼들이 배회하고 있었다.  그들이 아마');
         Print(7,'이 희미한 빛을 발하는 것 같았다.  당신이 약');
         Print(7,'간의 힘을 주어 빼어 보니 쉽게 벽에서 떨어져');
         Print(7,'나왔다.');
         k := 0;
         for i := 1 to 5 do
            if exist(i) then  k := i;
         if k > 0 then begin
            s := player[k].name + ReturnBJosa(player[k].name);
            Print(7,' 그걸 보더니 '+s+' 말했다.');
            Print(7,'');
            Print(9,' 아니, 이건....  이건 바로 그 전설 속에서나');
            cPrint(9,11,'논해지던 ','영혼의 크리스탈','임에 틀림없네. 이것');
            Print(9,'은 전세계에 두개 밖에 존재하지 않는 귀한 것');
            Print(9,'인데 우리가 발견했군.');
            Print(7,'');
            PressAnyKey;
         end;
         setbit(200);
         inc(party.crystal[5]);
      end;

      if on(75,60) and getbit(21) and (Real_Map(75,61) <> 43) then begin
         PutMap(75,61,43);
         Silent_Scroll;
      end;
      if on(76,61) and getbit(22) and (Real_Map(77,61) <> 43) then begin
         PutMap(77,61,43);
         Silent_Scroll;
      end;
      if on(77,59) and (not getbit(88)) then begin
         enemynumber := 8;
         for i := 1 to 3 do joinenemy(i,39);
         for i := 4 to 5 do joinenemy(i,40);
         for i := 6 to 7 do joinenemy(i,41);
         joinenemy(8,43);
         DisplayEnemies(TRUE);
         Clear;
         Print(13,' 신성한 신의 제단에 더러운 발을 디딘 놈들은');
         Print(13,'누구냐?  신을 모독한 너희네 인간들에게 몸소');
         Print(13,'가르침을 주겠다. 밧아랏!!');
         PressAnyKey;
         BattleMode(FALSE,TRUE);
         if party.etc[6] = 254 then exit;
         if party.etc[6] = 2 then begin
            inc(y);
            Silent_Scroll;
            exit;
         end;
         Clear;
         Print(7,' 당신은 대제사장으로부터 다이아몬드키 두 개');
         Print(7,'를 빼았았다.');
         setbit(88);
      end;

      if (y = 39) and getbit(88) and ((party.etc[30] shr 4) = (x - 63) div 4) then begin
         if Real_Map(x,y-1) <> 43 then begin
            for j := y-2 to y-1 do
            for i := x-1 to x do PutMap(i,j,43);
            Silent_Scroll;
         end;
      end;
      if (y = 82) and getbit(88) and ((party.etc[30] and $0F) = (x - 64) div 4) then begin
         if Real_Map(x,y+1) <> 43 then begin
            for j := y+1 to y+2 do
            for i := x to x+1 do PutMap(i,j,43);
            Silent_Scroll;
         end;
      end;

      if on(68,25) then begin
         if getbit(147) then exit;
         if (party.etc[31] and BIT1) > 0 then begin
            if getbit(24) then begin
               if getbit(134) then exit;
battle1:
               enemynumber := 1;
               joinenemy(1,46);
               Clear;
               Print(7,' 갑자기 보물상자의 양 옆에서 팔이 나오고 밑');
               Print(7,'에서 다리가 나오더니  괴물로 변해 당신을 공');
               Print(7,'격하기 시작했다.  당신은  그것이 보물상자의');
               Print(7,'모습을 하고 있는  미미크라는 것을 금방 알아');
               Print(7,'차렸다.');
               PressAnyKey;
               DisplayEnemies(TRUE);
               BattleMode(FALSE,TRUE);
               if party.etc[6] = 254 then exit;
               if party.etc[6] = 2 then begin
                  inc(y);
                  Silent_Scroll;
                  exit;
               end;
               PutMap(69,25,43);
               Silent_Scroll;
               setbit(134);
            end else if getbit(11) then begin
               {$B+}
               Clear;
               AllRight := TRUE;
               Print(7,' 당신이 보물상자 앞으로 다가섰을때  상자 위');
               Print(7,'의 두개골이 당신에게 질문을 던졌다.');
               PressAnyKey;
               Print(15,' 1편 <또 다른 지식의 성전>과 2편 <다크 메이');
               Print(15,'지 실리안 카미너스>에  모두 출현했던 인물이');
               Print(15,'아닌 것은 누구인가?');
               m[0] := '';
               m[1] := '로드안';
               m[2] := '네크로만서';
               m[3] := '레드 안타레스';
               m[4] := '알비레오';
               AllRight := AllRight and Random_Order(4);
               Print(15,' 이 게임의 1,2,3 편에 모두 출현한 인물은 누');
               Print(15,'구인가?');
               m[0] := '';
               m[1] := '실리안 카미너스';
               m[2] := '안타레스 Jr.';
               m[3] := '드라코니안';
               m[4] := '에인션트 이블';
               AllRight := AllRight and Random_Order(4);
               Print(15,' 이 게임에서 1,3 편만 출현한 인물이 아닌 것');
               Print(15,'은 누구인가?');
               m[0] := '';
               m[1] := '카노푸스';
               m[2] := '안타레스 Jr.';
               m[3] := '드라코니안';
               m[4] := '제작자(안영기)';
               AllRight := AllRight and Random_Order(4);
               if AllRight then begin
                  Print(7,' 보물상자는 스스로 스르륵 열렸다.');
                  Print(7,'');
                  Print(11,' [ 인내력 + 0 에서 + 4 ]');
                  for i := 1 to 6 do
                  if player[i].name <> '' then
                     player[i].endurance := player[i].endurance + (player[i].luck div 5);
                  setbit(147);
               end else begin
                  setbit(24);
                  goto battle1;
               end;
               {$B-}
            end else begin
               Clear;
               Print(7,' 당신이 보물상자 앞으로 다가섰을때  상자 위');
               Print(7,'의 두개골이 무어라 말을 했지만 전혀 알아 들');
               Print(7,'을 수가 없었다.');
            end;
         end else begin
            Clear;
            Print(7,' 당신이 보물상자 앞으로 다가섰지만  상자 위');
            Print(7,'의 두개골은 아무말도 하지 않았다.');
         end;
      end;
      if on(72,25) then begin
         if getbit(148) then exit;
         Clear;
         if (party.etc[31] and BIT2) > 0 then begin
            if getbit(25) then begin
               if getbit(135) then exit;
battle2:
               enemynumber := 1;
               joinenemy(1,46);
               Clear;
               Print(7,' 갑자기 보물상자의 양 옆에서 팔이 나오고 밑');
               Print(7,'에서 다리가 나오더니  괴물로 변해 당신을 공');
               Print(7,'격하기 시작했다.  당신은  그것이 보물상자의');
               Print(7,'모습을 하고 있는  미미크라는 것을 금방 알아');
               Print(7,'차렸다.');
               PressAnyKey;
               DisplayEnemies(TRUE);
               BattleMode(FALSE,TRUE);
               if party.etc[6] = 254 then exit;
               if party.etc[6] = 2 then begin
                  inc(y);
                  Silent_Scroll;
                  exit;
               end;
               PutMap(73,25,43);
               Silent_Scroll;
               setbit(135);
            end else if getbit(11) then begin
               {$B+}
               AllRight := TRUE;
               Print(7,' 당신이 보물상자 앞으로 다가섰을때  상자 위');
               Print(7,'의 두개골이 당신에게 질문을 던졌다.');
               PressAnyKey;
               j := random(100) + 1;
               str(j : 2,s);
               Print(15,' 당신은  핵융합 마법을  종종 사용하곤 한다.');
               Print(15,'당신이 공기 중에 분포 해 있는  수소원자 4개');
               Print(15,'를 헬륨원자 1개로 핵융합 시켰을때  질량결손');
               Print(15,'이 '+s+' mg 이라면 적에게 방출된 에너지는 얼마');
               Print(15,'인가?');
               m[0] := '';
               str((j* 3) / 100 : 4:2,m[1]);
               str((j* 1) / 100 : 4:2,m[2]);
               str((j*10) / 100 : 4:2,m[3]);
               str((j* 9) / 100 : 4:2,m[4]);
               for i := 1 to 4 do m[i] := m[i] + ' x 10^15';
               AllRight := AllRight and Random_Order(4);
               Print(15,' 당신은 종종 공간이동을 하여  위치를 이동하');
               Print(15,'기도 한다.  그리고 그때 당신은 3차원의 공간');
               Print(15,'에  강한 중력을 걸어  공간을 압축 시킨후 그');
               Print(15,'공간면을 뚫고  이동하고 나서  공간을 원위치');
               Print(15,'시킴으로써(워프 방식) 그것을 가능하게 한다.');
               Print(15,'이것은 무슨 법칙으로 증명될 수 있겠는가?');
               m[0] := '';
               m[1] := '질량보존의 법칙';
               m[2] := '작용 반작용의 법칙';
               m[3] := '특수 상대성 이론';
               m[4] := '일반 상대성 이론';
               AllRight := AllRight and Random_Order(4);
               Print(15,' 당신은 ''마법 화구''라는  불공을 만들어 적에');
               Print(15,'게 던져 제압해본 경험이 있다. 당신은 당신의');
               Print(15,'손 위에 불덩어리를 만들기 위해서  이 물질을');
               Print(15,'결합시킨다. 이 물질의 이름은 무엇인가?');
               m[0] := '';
               m[1] := 'Hydrogen';
               m[2] := 'Carbon';
               m[3] := 'Nitrogen';
               m[4] := 'Oxygen';
               AllRight := AllRight and Random_Order(4);
               if AllRight then begin
                  Print(7,' 보물상자는 스스로 스르륵 열렸다.');
                  Print(7,'');
                  Print(11,' [ 소환의 크리스탈 + 1 ]');
                  inc(party.crystal[6]);
                  setbit(148);
               end else begin
                  setbit(25);
                  goto battle2;
               end;
               {$B-}
            end else begin
               Print(7,' 당신이 보물상자 앞으로 다가섰을때  상자 위');
               Print(7,'의 두개골이 무어라 말을 했지만 전혀 알아 들');
               Print(7,'을 수가 없었다.');
            end;
         end else begin
            Print(7,' 당신이 보물상자 앞으로 다가섰지만  상자 위');
            Print(7,'의 두개골은 아무말도 하지 않았다.');
         end;
      end;
      if on(76,25) then begin
         if getbit(149) then exit;
         Clear;
         if (party.etc[31] and BIT3) > 0 then begin
            if getbit(26) then begin
               if getbit(136) then exit;
battle3:
               enemynumber := 1;
               joinenemy(1,46);
               Clear;
               Print(7,' 갑자기 보물상자의 양 옆에서 팔이 나오고 밑');
               Print(7,'에서 다리가 나오더니  괴물로 변해 당신을 공');
               Print(7,'격하기 시작했다.  당신은  그것이 보물상자의');
               Print(7,'모습을 하고 있는  미미크라는 것을 금방 알아');
               Print(7,'차렸다.');
               PressAnyKey;
               DisplayEnemies(TRUE);
               BattleMode(FALSE,TRUE);
               if party.etc[6] = 254 then exit;
               if party.etc[6] = 2 then begin
                  inc(y);
                  Silent_Scroll;
                  exit;
               end;
               PutMap(77,25,43);
               Silent_Scroll;
               setbit(136);
            end else if getbit(11) then begin
               {$B+}
               AllRight := TRUE;
               Print(7,' 당신이 보물상자 앞으로 다가섰을때  상자 위');
               Print(7,'의 두개골이 당신에게 질문을 던졌다.');
               PressAnyKey;
               m[0] := '';
               m[1] := '              맞다';
               m[2] := '             아니다';
               Print(15,' 달과 지구의 나이는 같거나 지구가 더 많다.');
               if Select(180,2,2,FALSE,TRUE) <> 2 then AllRight := FALSE;
               Print(15,' 예전에는 화성과 목성 사이에 혹성이 하나 있');
               Print(15,'었다.');
               if Select(180,2,2,FALSE,TRUE) <> 1 then AllRight := FALSE;
               Print(15,' 태양의 나이는 50 억살이다.  80 억년 전에도');
               Print(15,'지금의 태양 자리에 항성이 있었을 것이다.');
               if Select(180,2,2,FALSE,TRUE) <> 1 then AllRight := FALSE;
               Print(15,' 우주의 크기는 변함이 없다.');
               if Select(180,2,2,FALSE,TRUE) <> 2 then AllRight := FALSE;
               Print(15,' 태양계 혹성의 순서는  수성, 금성, 지구,...');
               Print(15,'천왕성, 해왕성, 명왕성의 순서로 일정하다.');
               if Select(180,2,2,FALSE,TRUE) <> 2 then AllRight := FALSE;
               Print(15,' 토성을 물에 띄우면 뜬다.');
               if Select(180,2,2,FALSE,TRUE) <> 1 then AllRight := FALSE;
               if AllRight then begin
                  Print(7,' 보물상자는 스스로 스르륵 열렸다.');
                  Print(7,'');
                  Print(11,' [ 화염의 크리스탈 + 1 ]');
                  inc(party.crystal[1]);
                  setbit(149);
               end else begin
                  setbit(26);
                  goto battle3;
               end;
               {$B-}
            end else begin
               Print(7,' 당신이 보물상자 앞으로 다가섰을때  상자 위');
               Print(7,'의 두개골이 무어라 말을 했지만 전혀 알아 들');
               Print(7,'을 수가 없었다.');
            end;
         end else begin
            Print(7,' 당신이 보물상자 앞으로 다가섰지만  상자 위');
            Print(7,'의 두개골은 아무말도 하지 않았다.');
         end;
      end;
      if on(80,25) then begin
         if getbit(150) then exit;
         Clear;
         if (party.etc[31] and BIT4) > 0 then begin
            if getbit(27) then begin
               if getbit(137) then exit;
battle4:
               enemynumber := 1;
               joinenemy(1,46);
               Clear;
               Print(7,' 갑자기 보물상자의 양 옆에서 팔이 나오고 밑');
               Print(7,'에서 다리가 나오더니  괴물로 변해 당신을 공');
               Print(7,'격하기 시작했다.  당신은  그것이 보물상자의');
               Print(7,'모습을 하고 있는  미미크라는 것을 금방 알아');
               Print(7,'차렸다.');
               PressAnyKey;
               DisplayEnemies(TRUE);
               BattleMode(FALSE,TRUE);
               if party.etc[6] = 254 then exit;
               if party.etc[6] = 2 then begin
                  inc(y);
                  Silent_Scroll;
                  exit;
               end;
               PutMap(81,25,43);
               Silent_Scroll;
               setbit(137);
            end else if getbit(11) then begin
               {$B+}
               AllRight := TRUE;
               Print(7,' 당신이 보물상자 앞으로 다가섰을때  상자 위');
               Print(7,'의 두개골이 당신에게 질문을 던졌다.');
               PressAnyKey;
               m[0] := '';
               m[1] := '              맞다';
               m[2] := '             아니다';
               Print(15,' BASIC 언어의  '';''(세미콜론)은  문장의 끝을');
               Print(15,'의미한다');
               if Select(180,2,2,FALSE,TRUE) <> 2 then AllRight := FALSE;
               Print(15,' Pascal에서 대입 기호는 ''=''이다.');
               if Select(180,2,2,FALSE,TRUE) <> 2 then AllRight := FALSE;
               Print(15,' C 언어는  영문 소문자를  기본으로 설계되었');
               Print(15,'다.');
               if Select(180,2,2,FALSE,TRUE) <> 1 then AllRight := FALSE;
               Print(15,' FORTRAN은 subroutine 기능이 없다.');
               if Select(180,2,2,FALSE,TRUE) <> 2 then AllRight := FALSE;
               Print(15,' Small Talk, C++, Pascal은 현재 모두 객체지');
               Print(15,'향 프로그래밍을 지원한다.');
               if Select(180,2,2,FALSE,TRUE) <> 1 then AllRight := FALSE;
               if AllRight then begin
                  Print(7,' 보물상자는 스스로 스르륵 열렸다.');
                  Print(7,'');
                  Print(11,' [ 체력 또는 정신력 + 0 에서 + 2 ]');
                  for i := 1 to 6 do
                  if player[i].name <> '' then begin
                     j := ((player[i].luck div 5) + 1) div 2;
                     if player[i].classtype = magic then
                        player[i].mentality := player[i].mentality + j
                     else
                        player[i].strength := player[i].strength + j;
                  end;
                  setbit(150);
               end else begin
                  setbit(27);
                  goto battle4;
               end;
               {$B-}
            end else begin
               Print(7,' 당신이 보물상자 앞으로 다가섰을때  상자 위');
               Print(7,'의 두개골이 무어라 말을 했지만 전혀 알아 들');
               Print(7,'을 수가 없었다.');
            end;
         end else begin
            Print(7,' 당신이 보물상자 앞으로 다가섰지만  상자 위');
            Print(7,'의 두개골은 아무말도 하지 않았다.');
         end;
      end;
      if on(84,25) then begin
         if (not getbit(23)) then begin
            Clear;
            Print(7,' 당신이 앞에 있는 보물상자를 보았을때  섬찟');
            Print(7,'함을 느끼며 한 걸음 물러섰다.  그 상자 위에');
            Print(7,'는 인간의 해골이 앉아 있었고 그 해골에는 두');
            Print(7,'눈동자와 머리카락이 듬성듬성 붙어 있었다.');
            Print(7,' 스르르 해골이 고개를 들며 당신을 노려 보았');
            Print(7,'다. 당신은 다시 한 걸음을 물러섰다.  그러자');
            Print(7,'그 해골은 뼈뿐인 두 손을 들어 당신을 가리켰');
            Print(7,'다. 그리고 인간의 말을 하기 시작했다.');
            Print(7,'');
            Print(9,' 당신은 당신들이 지금하고 있는 일이 어떤 것');
            Print(9,'인지 모르고 있다.  지금 이 시대가  정의라고');
            Print(9,'생각하는 것을 역사가 반드시 정의라고 평가짓');
            Print(9,'지는 않을 것이다. 당신이 만약 에인션트 이블');
            Print(9,'을 만나지 않았다면 당장 그를 만나보아라. 그');
            Print(9,'를 통해 당신은 진정한 정의를 체험하게 될 것');
            Print(9,'이다. 게다가 너는 ...');
            Print(7,'');
            Print(7,' 그가  이런 말을 하고 있을때  갑자기 천정을');
            Print(7,'뚫고 직격뇌진이 그를 강타했다.  당신은 순간');
            Print(7,'적으로 벌어진 이 일을 보고  넋나간듯 얼마동');
            Print(7,'안 있다가 산산히 흩어진 뼈를 보며 방금의 말');
            Print(7,'을 되새겼다.');
            Print(7,'');
            PressAnyKey;
            setbit(23);
         end;
         if (party.etc[31] and BIT5) > 0 then begin
            if getbit(151) then exit;
            Clear;
            Print(7,' 당신은 해골이 걸터 앉아 있던 보물상자를 열');
            Print(7,'었다.');
            Print(7,'');
            Print(11,' [ 크로매틱 방패 + 1 ]');
            Print(11,' [ 브리간디 + 1 ]');
            Print(11,' [ 철퇴 + 1 ]');
            if party.BackPack[2,5] < 255 then inc(party.BackPack[2,6]);
            if party.BackPack[5,4] < 255 then inc(party.BackPack[5,4]);
            if party.BackPack[6,5] < 255 then inc(party.BackPack[6,5]);
            setbit(151);
         end;
      end;

      if (on(76,90) or on(77,90)) and (not getbit(87)) then begin
         Clear;
         enemynumber := 5;
         for i := 1 to 2 do joinenemy(i,41);
         joinenemy(3,40);
         joinenemy(4,42);
         joinenemy(5,44);
         DisplayEnemies(TRUE);
         Print(13,' 나는 코볼트킹님의 근위대의 대장이다.  내가');
         Print(13,'살아 있는한  너희들을 결코 이 안으로 한발자');
         Print(13,'국도 들여놓지 못할 것이다.');
         PressanyKey;
         BattleMode(FALSE,TRUE);
         if party.etc[6] = 254 then exit;
         if party.etc[6] = 2 then begin
            inc(y);
            Silent_Scroll;
            exit;
         end;
         setbit(87);
      end;
      if (on(76,86) or on(77,86)) and (not getbit(86)) then begin
         Clear;
         enemynumber := 1;
         joinenemy(1,45);
         DisplayEnemies(TRUE);
         Print(13,' 지상 최상 최대의 마도사인 나, 코볼트킹에게');
         Print(13,'도전해 오다니 전말 배짱 한번 좋구나. 네놈들');
         Print(13,'은 나 혼자서 상대하겠다. 가소로운 것들...');
         PressAnyKey;
         repeat
            BattleMode(FALSE,TRUE);
            if party.etc[6] = 254 then exit;
            if party.etc[6] = 2 then begin
               Clear;
               Print(7,' 당신은 코볼트킹에게서 도망치려 했지만 그가');
               Print(7,'만든 결계를 벗어 날 수가 없었다.');
               PressAnyKey;
               DisplayEnemies(TRUE);
            end;
         until party.etc[6] = 0;
         Clear;
         Print(7,' 당신이  코볼트킹을 물리쳤구나라고 생각했을');
         Print(7,'때 코볼트킹은 공간이동의 마법을 써서 어디론');
         Print(7,'가 사라져 버렸다. 당신은 당황해서 이곳 전지');
         Print(7,'역을 투시해 보았지만 그는 없었다.');
         setbit(86);
      end;
   end;

   if mapname = 'HdsGate' then begin
      if on(25,30) then begin
         Clear;
         if Real_Map(20,27) = 40 then begin
            i := 40; j := 41;
            Print(7,' 당신은 레버를 왼쪽으로 당겼다.');
         end
         else begin
            i := 41; j := 40;
            Print(7,' 당신은 레버를 오른쪽으로 당겼다.');
         end;
         PutMap(20,27,j);
         PutMap(22,28,j);
         PutMap(21,29,i);
         PutMap(23,31,i);
         PutMap(15,32,i);
         PutMap(16,33,j);
         PutMap(119,34,j);
         PutMap(17,35,i);
         PutMap(24,33,j);
         PutMap(28,33,i);
         PutMap(25,35,j);
         PutMap(27,35,i);
         PutMap(22,36,i);
         PutMap(23,39,i);
         Silent_Scroll;
         exit;
      end;
      if on(23,15) then begin
         Clear;
         if Real_Map(23,28) = 40 then begin
            i := 40; j := 41;
            Print(7,' 당신은 레버를 왼쪽으로 당겼다.');
         end
         else begin
            i := 41; j := 40;
            Print(7,' 당신은 레버를 오른쪽으로 당겼다.');
         end;
         PutMap(21,27,i);
         PutMap(23,28,j);
         PutMap(20,30,i);
         PutMap(22,30,j);
         PutMap(19,32,i);
         PutMap(17,33,i);
         PutMap(18,34,j);
         PutMap(16,35,j);
         PutMap(26,32,j);
         PutMap(28,32,i);
         PutMap(25,34,j);
         PutMap(27,34,j);
         PutMap(23,38,j);
         PutMap(21,39,j);
         exit;
      end;
      if on(23,19) then begin
         Clear;
         if Real_Map(20,29) = 40 then begin
            i := 40; j := 41;
            Print(7,' 당신은 레버를 왼쪽으로 당겼다.');
         end
         else begin
            i := 41; j := 40;
            Print(7,' 당신은 레버를 오른쪽으로 당겼다.');
         end;
         PutMap(23,27,i);
         PutMap(20,29,j);
         PutMap(22,29,j);
         PutMap(21,31,i);
         PutMap(16,32,i);
         PutMap(18,33,i);
         PutMap(16,34,j);
         PutMap(19,35,i);
         PutMap(25,32,j);
         PutMap(27,33,j);
         PutMap(24,34,i);
         PutMap(26,34,i);
         PutMap(22,37,i);
         PutMap(20,38,i);
         exit;
      end;
      if on(27,15) then begin
         Clear;
         if Real_Map(21,28) = 40 then begin
            i := 40; j := 41;
            Print(7,' 당신은 레버를 왼쪽으로 당겼다.');
         end
         else begin
            i := 41; j := 40;
            Print(7,' 당신은 레버를 오른쪽으로 당겼다.');
         end;
         PutMap(22,27,i);
         PutMap(21,28,j);
         PutMap(23,29,i);
         PutMap(20,31,j);
         PutMap(18,32,i);
         PutMap(19,33,j);
         PutMap(17,34,j);
         PutMap(15,35,i);
         PutMap(24,32,j);
         PutMap(27,32,j);
         PutMap(26,33,i);
         PutMap(24,35,j);
         PutMap(28,35,i);
         PutMap(23,37,i);
         PutMap(21,40,i);
         exit;
      end;
      if on(27,19) then begin
         Clear;
         if Real_Map(20,28) = 40 then begin
            i := 40; j := 41;
            Print(7,' 당신은 레버를 왼쪽으로 당겼다.');
         end
         else begin
            i := 41; j := 40;
            Print(7,' 당신은 레버를 오른쪽으로 당겼다.');
         end;
         PutMap(20,28,j);
         PutMap(21,30,j);
         PutMap(23,30,j);
         PutMap(22,31,i);
         PutMap(17,32,i);
         PutMap(15,33,i);
         PutMap(15,34,j);
         PutMap(18,35,j);
         PutMap(25,31,i);
         PutMap(28,34,i);
         PutMap(26,35,j);
         PutMap(21,38,j);
         PutMap(22,39,j);
         exit;
      end;
      if map^[x,y] = Real_Map(x,y) then begin
         Clear;
         Print(12,' 당신이 물 속으로 발을 디디자  순식간에 온');
         Print(12,'몸이 타버렸다.');
         for i := 1 to 6 do
         with player[i] do
         if name <> '' then begin
            hp := 0;
            dead := 1;
         end;
         Display_Condition;
         PressAnyKey;
         Clear;
         party.etc[6] := 255;
         GameOver;
         exit;
      end;
   end;

   if mapname = 'Dome' then begin
      if (x in [5,46]) or (y in [6,95]) then begin
         if wantexit then begin
            Print(9,' 당신이 발견한 이 장소는  분명 배리언트 피');
            Print(9,'플즈의 사람들을 로드안의 시각범위에 벗어나');
            Print(9,'게 하기에  충분한 곳일겁니다.  당신은 정말');
            Print(9,'훌륭한 일을 해내셨습니다.  제가  곧 당신을');
            Print(9,'지상으로 이동 시켜 드리겠습니다. 그리고 저');
            Print(9,'는  몇 년 정도 휴식을 취하려 합니다.  저의');
            Print(9,'영적 에너지를  마을을 건설하고 사람들을 이');
            Print(9,'동 시키는데 써버려서 에너지 충전 기간이 필');
            Print(9,'요합니다. 여태껏 당신의 도움들 정말 고마왔');
            Print(9,'습니다. 계속 자신이 결심한 의지대로 꿋꿋하');
            Print(9,'게 나아가십시요.  저는 이제 뒷일을 모두 당');
            Print(9,'신에게 맡기겠습니다.  당신이라면 분명히 해');
            Print(9,'낼거라 믿습니다. 그럼, 안녕히...');
            PressAnyKey;
            mapname := 'Ground1';
            Load;
            with party do begin
               watch_year := year;
               watch_day := day;
               watch_hour := hour;
               watch_min := min;
               watch_sec := sec;
            end;
            Time_Watch := TRUE;
            Time_Event_No := 3;
            watch_min := watch_min + 90;
            if watch_min > 59 then begin
               watch_min := watch_min - 60;
               watch_hour := watch_hour + 1;
               if watch_hour > 23 then begin
                  watch_hour := watch_hour - 24;
                  watch_day := watch_day + 1;
                  if watch_day > 359 then begin
                     watch_day := watch_day - 360;
                     watch_year := watch_year + 1;
                  end;
               end;
            end;
            x := 80; y := 80;
            Scroll(TRUE);
         end else begin
            x := x - x1;
            y := y - y1;
            Silent_Scroll;
         end;
      end;
   end;

   if mapname = 'Light' then begin
      if y = 70 then begin
         if wantexit then DefaultExit
         else begin
            dec(y);
            Silent_Scroll;
         end;
      end;
      if (y = 43) and (not getbit(33)) then begin
         i := 38 - x + 5;
         for j := 1 to 5 do begin
            if j > 1 then PutTile(i,j-1,42);
            PutTile(i,j,53);
            if j < 5 then delay(500);
         end;
         Clear;
         Print(7,'나는 이번 반란을 지휘하고 있는 카미너스라는');
         Print(7,'사람이오. 몇일 전에 우리 성에 에인션트 이블');
         Print(7,'의 의지가 다녀갔소. 그리고 이 세상의 진실을');
         Print(7,'어렴풋이 알게 되었소.  우리는 항상 로드안이');
         Print(7,'말하는 것을 그대로 믿어왔소. 그건 여태껏 알');
         Print(7,'려진 그의 명성 때문이었다오.  하지만 이제는');
         Print(7,'예외가 있다는걸 깨닭게 되었소.');
         Print(7,'당신은 그의 명령대로 오크, 트롤, 코볼트, 드');
         Print(7,'라코니안 이 네종족을 제거하여 인간을 이롭게');
         Print(7,'한건 사실이오. 당신 또한 그 일을 자랑스럽게');
         Print(7,'생각할지도 모르오.  하지만  우리의 입장에서');
         Print(7,'볼때 그렇다는 것이지, 절대로 다른 종족의 입');
         Print(7,'장에서는 당신이 한 일이 정의를 위한 것이 아');
         Print(7,'니라오.  실제로 잘못은 우리가 했으면서 도리');
         Print(7,'어 그들에게 잘못을 덮어 씌워서  그들을 해한');
         Print(7,'것이지않소. 당신이 에인션트 이블을 만났다는');
         Print(7,'말을 들었소. 그렇다면 우리가 지금 하려는 일');
         Print(7,'을 이해할거요.  우리들은 당신이 우리의 편에');
         Print(7,'서서 로드안을 응징해 주기를 바라고 있소.');
         Print(7,' 자, 선택은 당신에게 있소.');
         Print(7,'');
         Print(7,'');
         Pause(FALSE);
         for i := 1 to 7 do Print(7,'');
         Pause(TRUE);
         m[0] := '';
         m[1] := '로드안을 배신한다';
         m[2] := '로드안의 말대로 이들을 벌한다';
         if Select(200,2,2,FALSE,TRUE) = 1 then begin
            setbit(33);
            party.etc[25] := 2;
            Print(7,' 우리 성의 사람들은 당신의 용기 있는 결단에');
            Print(7,'찬사를 보내고 있소. 정말 장한 일이오.');
            with party do begin
               watch_year := year;
               watch_day := day;
               watch_hour := hour;
               watch_min := min;
               watch_sec := sec;
            end;
            Time_Watch := TRUE;
            Time_Event_No := 0;
            watch_min := watch_min + 10;
            if watch_min > 59 then begin
               watch_min := watch_min - 60;
               watch_hour := watch_hour + 1;
               if watch_hour > 23 then begin
                  watch_hour := watch_hour - 24;
                  watch_day := watch_day + 1;
                  if watch_day > 359 then begin
                     watch_day := watch_day - 360;
                     watch_year := watch_year + 1;
                  end;
               end;
            end;
            for i := 2 to 5 do begin
               for j := 0 to 8 do player[i].name[j+9] := player[i].name[j];
               player[i].name[0] := chr(0);
            end;
            Display_Condition;
            i := 38 - x + 5;
            for j := 5 downto 1 do begin
               PutTile(i,j,42);
               if j > 1 then begin
                  PutTile(i,j-1,53);
                  delay(500);
               end;
            end;
         end else begin
            party.etc[25] := 1;
            enemynumber := 8;
            for i := 1 to 8 do joinenemy(i,64);
            DisplayEnemies(TRUE);
            repeat
               BattleMode(FALSE,TRUE);
               if party.etc[6] = 254 then exit;
               if party.etc[6] = 2 then Clear;
            until party.etc[6] = 0;
            Clear;
            enemynumber := 8;
            for i := 1 to 7 do joinenemy(i,64);
            joinenemy(8,65);
            DisplayEnemies(TRUE);
            repeat
               BattleMode(FALSE,TRUE);
               if party.etc[6] = 254 then exit;
               if party.etc[6] = 2 then Clear;
            until party.etc[6] = 0;
            Clear;
            enemynumber := 8;
            for i := 1 to 4 do joinenemy(i,64);
            for i := 5 to 7 do joinenemy(i,65);
            joinenemy(8,66);
            DisplayEnemies(TRUE);
            repeat
               BattleMode(FALSE,TRUE);
               if party.etc[6] = 254 then exit;
               if party.etc[6] = 2 then Clear;
            until party.etc[6] = 0;
            setbit(33);
            party.etc[20] := 9;
            Clear;
            Print(7,' 하지만  카미너스는  배리언트 피플즈의 남은');
            Print(7,'주민들을 데리고  성을 버린채  게이트를 통해');
            Print(7,'도망가 버렸다.');
         end;
      end;
   end;

   if mapname = 'Dark' then begin
      if y = 95 then begin
         if wantexit then DefaultExit
         else begin
            dec(y);
            Silent_Scroll;
         end;
      end;
   end;

end;


Procedure SpecialEvent;
begin
   SpecialEvent_Sub2;
   SpecialEvent_Sub1;
end;

end.